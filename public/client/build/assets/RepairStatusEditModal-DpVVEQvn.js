import{r as i,j as o,b2 as C,S as F,bH as y,F as P,T as k,ab as w,s as I}from"./index-C9HasOiM.js";import{u as v,b as z,C as M,t as N}from"./index-BTi6rd4V.js";import{a as V}from"./repair-C13Y1Qe-.js";import{u as A}from"./useRepair-Cho1bqHB.js";import"./repair-DgMqRd6F.js";const W=({status:e,open:t,onClose:a})=>{var u,d;const s=i.useRef(null);i.useEffect(()=>{if(!t)return;const r=setTimeout(()=>{t&&s.current&&s.current.focus()},100);return()=>clearTimeout(r)},[t]);const{control:m,register:p,handleSubmit:h,getValues:x,formState:{errors:l},setError:E,reset:n}=v({resolver:N(V)}),b={color:(e==null?void 0:e.color)||"default",name:(e==null?void 0:e.name)||""},{isDirty:S}=z({control:m}),c=()=>!S;i.useEffect(()=>{e&&n(b)},[e]);const{updateRepairStatus:g}=A(),j=async r=>{if(!c())return new Promise((R,f)=>{g.mutateAsync({statusId:e.id,...r}).then(()=>{a(),w("Estado atualizado com sucesso!"),n(),R()}).catch(T=>{if(T.error.code==="REP-007"){E("name",{type:"manual",message:"Nome jÃ¡ existente"}),f();return}a(),I("Erro ao atualizar estado!"),n(),f()})})};return o.jsx(C,{mode:"form",title:"Editar Estado",open:t,onClose:a,submitButtonText:"Editar Estado",onSubmit:h(j),disabled:c(),children:o.jsxs(F,{sx:{padding:3,gap:2},children:[o.jsx(M,{name:"color",control:m,render:({field:r})=>o.jsx(y,{label:"Cor",selected:r.value,onChange:r.onChange})}),o.jsx(P,{fullWidth:!0,children:o.jsx(k,{...p("name"),label:"Nome",error:!!l.name,helperText:(u=l.name)==null?void 0:u.message,autoComplete:"off",inputRef:s,InputLabelProps:{shrink:((d=x("name"))==null?void 0:d.length)>0}})})]})})};export{W as default};
