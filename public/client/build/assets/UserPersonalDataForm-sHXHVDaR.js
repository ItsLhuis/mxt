import{b as J,a as K,o as O,r as X,j as e,H as Y,S as E,G as s,aQ as r,a_ as a,F as d,T as p,B as u,b2 as Z,L as $}from"./index-D-gKbxy2.js";import{u as D,b as ee,C as N,t as oe}from"./index-DampQ2Jc.js";import{j as te}from"./user-_ZvJi3ui.js";import{C as ne}from"./mui-tel-input.es-BQ0Mi011.js";import"./isPossiblePhoneNumber-DES16dOz.js";const le=({user:l,isLoading:B,isError:z})=>{var L,f,b,y,v,w,S,T,F,U,k,I;const n=!B&&!z,A=J(),g=K(A.breakpoints.down("sm")),{control:x,register:h,handleSubmit:_,getValues:m,formState:{errors:t},reset:G}=D({resolver:oe(te)}),{updateUserPersonalData:j,findEmployeeByUserId:H}=O(),{data:o,isLoading:M,isError:P}=H(l==null?void 0:l.id),c=!M&&!P,Q={name:(o==null?void 0:o.name)||"",phoneNumber:(o==null?void 0:o.phone_number)||"",country:(o==null?void 0:o.country)||"",city:(o==null?void 0:o.city)||"",locality:(o==null?void 0:o.locality)||"",address:(o==null?void 0:o.address)||"",postalCode:(o==null?void 0:o.postal_code)||"",description:(o==null?void 0:o.description)||""},{isDirty:R}=ee({control:x}),C=()=>!R;X.useEffect(()=>{n&&c&&o&&l&&G(Q)},[n,c,o,l]);const V=async i=>{!n||!c||C()||await j.mutateAsync({userId:l.id,...i,description:i.description===""?null:i.description})};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Dados Pessoais",description:"Atualizar dados pessoais do utilizador"}),e.jsx("form",{onSubmit:_(V),children:e.jsxs(E,{sx:{paddingTop:1},children:[e.jsxs(s,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(p,{...h("name"),label:"Nome",error:!!t.name,helperText:(L=t.name)==null?void 0:L.message,autoComplete:"off",InputLabelProps:{shrink:((f=m("name"))==null?void 0:f.length)>0}})})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(N,{name:"phoneNumber",control:x,render:({field:i})=>{var W;return e.jsx(ne,{...i,value:i.value||"+351",onChange:q=>{i.onChange(q.replace(/\s+/g,""))},defaultCountry:"pt",label:"Contacto",variant:"outlined",fullWidth:!0,error:!!t.phoneNumber,helperText:(W=t.phoneNumber)==null?void 0:W.message,autoComplete:"off",disableDropdown:!0})}})})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(p,{...h("country"),label:"País",error:!!t.country,helperText:(b=t.country)==null?void 0:b.message,autoComplete:"off",InputLabelProps:{shrink:((y=m("country"))==null?void 0:y.length)>0}})})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(p,{...h("city"),label:"Cidade",error:!!t.city,helperText:(v=t.city)==null?void 0:v.message,autoComplete:"off",InputLabelProps:{shrink:((w=m("city"))==null?void 0:w.length)>0}})})})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(p,{...h("locality"),label:"Localidade",error:!!t.locality,helperText:(S=t.locality)==null?void 0:S.message,autoComplete:"off",InputLabelProps:{shrink:((T=m("locality"))==null?void 0:T.length)>0}})})})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(E,{sx:{flexDirection:g?"column":"row",gap:2},children:[e.jsx(u,{sx:{width:"100%"},children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(p,{...h("address"),label:"Morada",error:!!t.address,helperText:(F=t.address)==null?void 0:F.message,autoComplete:"off",InputLabelProps:{shrink:((U=m("address"))==null?void 0:U.length)>0}})})})}),e.jsx(u,{sx:{width:g?"100%":"60%"},children:e.jsx(r,{isLoading:!n,LoadingComponent:e.jsx(a,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(d,{fullWidth:!0,children:e.jsx(p,{...h("postalCode"),label:"Código Postal",error:!!t.postalCode,helperText:(k=t.postalCode)==null?void 0:k.message,autoComplete:"off",InputLabelProps:{shrink:((I=m("postalCode"))==null?void 0:I.length)>0}})})})})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(N,{name:"description",control:x,render:({field:i})=>e.jsx(Z,{value:i.value,onChange:i.onChange,isLoading:!n})})})]}),e.jsx(u,{sx:{marginLeft:"auto",padding:3},children:e.jsx($,{loading:j.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!n||!c||C(),children:"Atualizar Dados Pessoais"})})]})})]})};export{le as default};
