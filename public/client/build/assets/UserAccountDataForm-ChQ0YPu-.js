import{X as F,r as w,b as A,j as e,aA as T,Z as y,ad as o,ax as j,ap as f,a0 as L,a1 as b,B as k,a3 as v,a4 as P,aa as B,a5 as I}from"./index-BzXGUPkY.js";import{i as R}from"./user-BY9cR1Va.js";const W=({user:a,isLoading:S,isError:C})=>{var u,x,h,p;const s=!S&&!C,{register:l,handleSubmit:E,formState:{errors:t},setError:d,reset:U,watch:i}=F({resolver:P(R),defaultValues:{username:"",email:""}}),r={username:(a==null?void 0:a.username)||"",email:(a==null?void 0:a.email)||""},m=()=>{const n=i();return n.username===r.username&&n.email===r.email};w.useEffect(()=>{s&&a&&U(r)},[s,a]);const{updateUserProfile:c}=A(),z=async n=>{!s||m()||await c.mutateAsync(n).then(()=>B("Conta atualizada com sucesso!")).catch(g=>{g.error.code==="USR-001"?d("username",{type:"manual",message:"Nome de utilizador já existente"}):g.error.code==="USR-002"?d("email",{type:"manual",message:"E-mail já existente"}):I("Erro ao atualizar conta!")})};return e.jsxs(e.Fragment,{children:[e.jsx(T,{title:"Conta",description:"Atualizar dados da conta do utilizador"}),e.jsx("form",{onSubmit:E(z),children:e.jsxs(y,{sx:{paddingTop:1},children:[e.jsxs(o,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(j,{isLoading:!s,LoadingComponent:e.jsx(f,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(L,{fullWidth:!0,children:e.jsx(b,{...l("username"),label:"Nome de utilizador",error:!!t.username,helperText:(u=t.username)==null?void 0:u.message,InputLabelProps:{shrink:((x=i("username"))==null?void 0:x.length)>0}})})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(j,{isLoading:!s,LoadingComponent:e.jsx(f,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(L,{fullWidth:!0,children:e.jsx(b,{...l("email"),label:"E-mail",error:!!t.email,helperText:(h=t.email)==null?void 0:h.message,InputLabelProps:{shrink:((p=i("email"))==null?void 0:p.length)>0}})})})})]}),e.jsx(k,{sx:{marginLeft:"auto",padding:3},children:e.jsx(v,{loading:c.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!s||m(),children:"Atualizar Conta"})})]})})]})};export{W as default};
