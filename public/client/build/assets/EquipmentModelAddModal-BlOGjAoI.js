import{r as x,j as e,b2 as L,S as q,aM as w,aQ as A,F as b,b4 as v,T as F,ab as I,s as N}from"./index-C9HasOiM.js";import{u as R,C as y,t as B}from"./index-BTi6rd4V.js";import{m as k}from"./equipment-D4V42Xnu.js";import{u as Q}from"./useEquipment-ClzBGdbo.js";import"./equipment-DQ8Bx2dX.js";const D=({open:o,onClose:d})=>{var f;const{control:g,register:j,handleSubmit:E,formState:{errors:n},setError:S,reset:i}=R({resolver:B(k)}),m=x.useRef(null);x.useEffect(()=>{if(!o){i();return}const r=setTimeout(()=>{o&&m.current&&m.current.focus()},100);return()=>clearTimeout(r)},[o]);const{findAllEquipmentBrands:u,createNewEquipmentModel:M}=Q(),T=async r=>new Promise((a,s)=>{M.mutateAsync(r).then(()=>{d(),I("Modelo adicionado com sucesso!"),i(),a()}).catch(l=>{if(l.error.code==="EQU-005"){S("name",{type:"manual",message:"Nome jÃ¡ existente"}),s();return}d(),N("Erro ao adicionar modelo!"),i(),s()})});return e.jsx(L,{mode:"form",title:"Adicionar Modelo",open:o,onClose:d,submitButtonText:"Adicionar Modelo",onSubmit:E(T),disabled:u.isLoading,children:e.jsxs(q,{sx:{padding:3,gap:2},children:[e.jsx(w,{isLoading:u.isLoading,LoadingComponent:e.jsx(A,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(b,{fullWidth:!0,children:e.jsx(y,{name:"brandId",control:g,defaultValue:"",render:({field:r})=>{var p,h;const a=u.data??[],s=["",...a.map(t=>t.name)],l=((p=a.find(t=>t.id===r.value))==null?void 0:p.name)||"";return e.jsx(v,{ref:r.ref,inputRef:m,label:"Marca",data:s,value:l,onChange:t=>{const c=a.find(C=>C.name===t);r.onChange((c==null?void 0:c.id)||"")},error:!!n.brandId,helperText:(h=n.brandId)==null?void 0:h.message})}})})}),e.jsx(b,{fullWidth:!0,children:e.jsx(F,{...j("name"),label:"Nome",error:!!n.name,helperText:(f=n.name)==null?void 0:f.message,autoComplete:"off"})})]})})};export{D as default};
