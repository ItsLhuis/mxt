import{O as Q,at as X,X as Z,b as q,r as J,j as e,aA as K,Z as W,ad as a,ax as d,ap as l,a0 as c,a1 as m,a8 as z,bl as Y,B as u,a3 as $,a4 as D,aa as ee,a5 as se}from"./index-BzXGUPkY.js";import{j as oe}from"./user-BY9cR1Va.js";import{R as te,s as A}from"./sanitizeHTML-C6wbY_ne.js";const re=({user:h,isLoading:B,isError:M})=>{var b,C,f,w,v,T,S,U,k,E,I,F;const i=!B&&!M,R=Q(),g=X(R.breakpoints.down("sm")),{control:j,register:p,handleSubmit:H,formState:{errors:t},reset:P,watch:r}=Z({resolver:D(oe),defaultValues:{name:"",phoneNumber:"",country:"",city:"",locality:"",address:"",postalCode:"",description:""}}),{updateUserPersonalData:L,findEmployeeByUserId:V}=q(),{data:s,isLoading:_,isError:G}=V(h==null?void 0:h.id),x=!_&&!G,n={name:(s==null?void 0:s.name)||"",phoneNumber:(s==null?void 0:s.phone_number)||"",country:(s==null?void 0:s.country)||"",city:(s==null?void 0:s.city)||"",locality:(s==null?void 0:s.locality)||"",address:(s==null?void 0:s.address)||"",postalCode:(s==null?void 0:s.postal_code)||"",description:(s==null?void 0:s.description)||""},y=()=>{const o=r();return o.name===n.name&&o.phoneNumber===n.phoneNumber&&o.country===n.country&&o.city===n.city&&o.locality===n.locality&&o.address===n.address&&o.postalCode===n.postalCode&&(A(o.description)===""?"":o.description)===n.description};J.useEffect(()=>{i&&x&&h&&P(n)},[i,x,h]);const O=async o=>{!i||!x||y()||await L.mutateAsync({userId:h.id,...o,description:A(o.description)===""?null:o.description}).then(()=>ee("Dados pessoais atualizados com sucesso!")).catch(()=>se("Erro ao atualizar dados pessoais!"))};return e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Dados Pessoais",description:"Atualizar dados pessoais do utilizador"}),e.jsx("form",{onSubmit:H(O),children:e.jsxs(W,{sx:{paddingTop:1},children:[e.jsxs(a,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(m,{...p("name"),label:"Nome",error:!!t.name,helperText:(b=t.name)==null?void 0:b.message,InputLabelProps:{shrink:((C=r("name"))==null?void 0:C.length)>0}})})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(z,{name:"phoneNumber",control:j,render:({field:o})=>{var N;return e.jsx(Y,{...o,value:o.value||"+351",defaultCountry:"pt",label:"Contacto",variant:"outlined",fullWidth:!0,error:!!t.phoneNumber,helperText:(N=t.phoneNumber)==null?void 0:N.message,disableDropdown:!0})}})})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(m,{...p("country"),label:"País",error:!!t.country,helperText:(f=t.country)==null?void 0:f.message,InputLabelProps:{shrink:((w=r("country"))==null?void 0:w.length)>0}})})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(m,{...p("city"),label:"Cidade",error:!!t.city,helperText:(v=t.city)==null?void 0:v.message,InputLabelProps:{shrink:((T=r("city"))==null?void 0:T.length)>0}})})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(m,{...p("locality"),label:"Localidade",error:!!t.locality,helperText:(S=t.locality)==null?void 0:S.message,InputLabelProps:{shrink:((U=r("locality"))==null?void 0:U.length)>0}})})})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(W,{sx:{flexDirection:g?"column":"row",gap:2},children:[e.jsx(u,{sx:{width:"100%"},children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(m,{...p("address"),label:"Morada",error:!!t.address,helperText:(k=t.address)==null?void 0:k.message,InputLabelProps:{shrink:((E=r("address"))==null?void 0:E.length)>0}})})})}),e.jsx(u,{sx:{width:g?"100%":"60%"},children:e.jsx(d,{isLoading:!i,LoadingComponent:e.jsx(l,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(m,{...p("postalCode"),label:"Código Postal",error:!!t.postalCode,helperText:(I=t.postalCode)==null?void 0:I.message,InputLabelProps:{shrink:((F=r("postalCode"))==null?void 0:F.length)>0}})})})})]})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(z,{name:"description",control:j,render:({field:o})=>e.jsx(te,{value:o.value,onChange:o.onChange,isLoading:!i})})})]}),e.jsx(u,{sx:{marginLeft:"auto",padding:3},children:e.jsx($,{loading:L.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!i||!x||y(),children:"Atualizar Dados Pessoais"})})]})})]})};export{re as default};
