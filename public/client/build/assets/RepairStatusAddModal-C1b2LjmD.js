import{r as m,j as r,aU as E,S as j,bA as R,F as T,T as b,ak as g,s as C}from"./index-_NktdslD.js";import{u as A,C as w,t as F}from"./index-8QsUXVhp.js";import{a as k}from"./repair-j_MUsWAD.js";import{u as y}from"./useRepair-MRRzMLfz.js";const B=({open:t,onClose:a})=>{var u;const{control:c,register:l,handleSubmit:d,formState:{errors:n},setError:f,reset:s}=A({resolver:F(k)}),o=m.useRef(null);m.useEffect(()=>{if(!t){s();return}const e=setTimeout(()=>{t&&o.current&&o.current.focus()},100);return()=>clearTimeout(e)},[t]);const{createNewRepairStatus:p}=y(),x=async e=>new Promise((h,i)=>{p.mutateAsync(e).then(()=>{a(),g("Estado adicionado com sucesso!"),s(),h()}).catch(S=>{if(S.error.code==="REP-007"){f("name",{type:"manual",message:"Nome jÃ¡ existente"}),i();return}a(),C("Erro ao adicionar estado!"),s(),i()})});return r.jsx(E,{mode:"form",title:"Adicionar Estado",open:t,onClose:a,submitButtonText:"Adicionar Estado",onSubmit:d(x),children:r.jsxs(j,{sx:{padding:3,gap:2},children:[r.jsx(w,{name:"color",control:c,defaultValue:"default",render:({field:e})=>r.jsx(R,{label:"Cor",selected:e.value,onChange:e.onChange})}),r.jsx(T,{fullWidth:!0,children:r.jsx(b,{...l("name"),label:"Nome",error:!!n.name,helperText:(u=n.name)==null?void 0:u.message,autoComplete:"off",inputRef:o})})]})})};export{B as default};
