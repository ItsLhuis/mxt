import{X as E,r as l,b as A,j as e,a as R,aA as x,B as S,af as v,az as B,Z as F,a0 as u,a1 as c,a4 as z,aa as U,a5 as g}from"./index-BCLPk4lW.js";import{u as M}from"./user-Bho16HCH.js";import{a as W}from"./Settings-fmNAH-B2.js";import"./Container-oFTCd3xi.js";const L=()=>{var h,m,w;const{register:t,handleSubmit:j,formState:{errors:s},setError:P}=E({resolver:z(M)}),[o,a]=l.useState(!1),n=l.useRef(null);l.useEffect(()=>{const i=setTimeout(()=>{o&&n.current&&n.current.focus()},100);return()=>clearTimeout(i)},[o]);const{findUserProfile:r,updateUserPassword:b}=A(),p=!r.isLoading&&!r.isError,T=async i=>new Promise((y,d)=>{var f;p?b.mutateAsync({userId:(f=r==null?void 0:r.data)==null?void 0:f.id,...i}).then(()=>{a(!1),U("Senha atualizada com sucesso!"),y()}).catch(C=>{if(C.error.code==="USR-005"){P("password",{type:"manual",message:"Senha atual incorreta"}),d();return}a(!1),g("Erro ao atualizar senha!"),d()}):(a(!1),g("Erro ao atualizar senha!"),d())});return e.jsxs(e.Fragment,{children:[e.jsxs(R,{elevation:1,children:[e.jsx(x,{title:"Segurança",description:"Definições de Segurança",icon:e.jsx(W,{})}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:2,paddingBottom:2,paddingRight:3},children:[e.jsx(x,{title:"Senha",description:"Altere a sua senha"}),e.jsx(S,{sx:{paddingTop:2},children:e.jsx(v,{variant:"contained",color:"error",disabled:!p,onClick:()=>a(!0),children:"Alterar Senha"})})]})]}),e.jsx(B,{open:o,onClose:()=>a(!1),mode:"form",title:"Alterar Senha",submitButtonText:"Alterar Senha",color:"error",onSubmit:j(T),children:e.jsxs(F,{sx:{padding:3,gap:2},children:[e.jsx(u,{fullWidth:!0,children:e.jsx(c,{inputRef:n,...t("password"),type:"password",label:"Senha atual",error:!!s.password,helperText:(h=s.password)==null?void 0:h.message,autoComplete:"current-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...t("newPassword"),type:"password",label:"Nova senha",error:!!s.newPassword,helperText:(m=s.newPassword)==null?void 0:m.message,autoComplete:"new-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...t("confirmPassword"),type:"password",label:"Confirmar nova senha",error:!!s.confirmPassword,helperText:(w=s.confirmPassword)==null?void 0:w.message,autoComplete:"new-password"})})]})})]})};export{L as default};
