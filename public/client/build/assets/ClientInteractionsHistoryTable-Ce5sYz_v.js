import{r as n,j as e,S as o,at as v,au as h,l as t,D as j,B as s,aw as l,ax as g,y as d,a as C,ay as y,az as H,aA as _}from"./index-CeqpX1Nb.js";import{f as S,a as T}from"./date-Cygk3yQx.js";import{f as c}from"./phone-CUaemfYv.js";import{C as D,H as L}from"./History-BFPC7bZh.js";const E=({client:p,isLoading:f,isError:x})=>{const i=!f&&!x,m=n.useMemo(()=>[{id:"type",label:"Atividade",align:"left",sortable:!0},{id:"responsible_user",label:"Responsável",align:"left",sortable:!1,renderComponent:({row:r})=>e.jsxs(o,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(o,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(v,{alt:r.responsible_user.username,src:`${h}/users/${r.responsible_user.id}/avatar?size=80`,name:r.responsible_user.username}),e.jsxs(o,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.responsible_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.responsible_user.role})]})]}),e.jsx(j,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(o,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:S(r.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:T(r.created_at_datetime)})]})]})}],[]),b=n.useMemo(()=>({row:r})=>{const u=n.useMemo(()=>[{id:"field",label:"Campo",align:"left",sortable:!0},{id:"before",label:"Antes",align:"left",sortable:!0,renderComponent:({row:a})=>a.field==="Descrição"&&a.before?e.jsx(s,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:l(a.before)})}):a.field==="Contacto"&&a.before?c(a.before):a.before?a.before:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"after",label:"Depois",align:"left",sortable:!0,renderComponent:({row:a})=>a.field==="Descrição"&&a.after?e.jsx(s,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:l(a.after)})}):a.field==="Contacto"&&a.after?c(a.after):a.after?a.after:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"changed",label:"Alterado",align:"left",sortable:!0,renderComponent:({row:a})=>e.jsx(e.Fragment,{children:a.changed?e.jsx(D,{color:"success"}):e.jsx(g,{color:"error"})})}],[]);return e.jsx(s,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden",margin:3},children:e.jsx(d,{data:r.details??[],columns:u})})},[]);return e.jsxs(C,{elevation:1,children:[e.jsx(y,{title:"Histórico de Atividades",description:"Histórico de atividades sobre os clientes",icon:e.jsx(L,{})}),e.jsx(H,{isLoading:!i,LoadingComponent:e.jsx(_,{mode:"datatable"}),LoadedComponent:e.jsx(s,{sx:{margin:3,border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:e.jsx(d,{mode:"datatable",data:i?p[0].interactions_history:[],columns:m,ExpandableContentComponent:b})})})]})};export{E as default};
