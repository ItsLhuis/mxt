import{r as d,j as a,S as n,h as i,aV as C,aW as _,aE as H,aM as y,aN as S,B as l,b8 as m,b9 as T,aK as x,f as D,H as L,aZ as M,a_ as R}from"./index-DJpfvod0.js";import{f as b}from"./phone-B8ybmA3k.js";import{C as A}from"./Check-D1jSKKzw.js";import{H as E}from"./History-r8vFQPvs.js";import"./isPossiblePhoneNumber-DES16dOz.js";const B=({client:u,isLoading:v,isError:h})=>{var c;const r=!v&&!h,j=d.useMemo(()=>[{id:"type",label:"Atividade",align:"left",sortable:!0},{id:"responsible_user",visible:!1},{id:"created_at_datetime",label:"Responsável",align:"left",sortable:!0,renderComponent:({row:t})=>{var s,e,o,p,f;return a.jsx(a.Fragment,{children:a.jsxs(n,{sx:{flexDirection:"row",gap:2},children:[a.jsx(n,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:t!=null&&t.responsible_user?a.jsxs(a.Fragment,{children:[a.jsx(C,{alt:(s=t==null?void 0:t.responsible_user)==null?void 0:s.username,src:`${_}/users/${(e=t==null?void 0:t.responsible_user)==null?void 0:e.id}/avatar?size=80`,name:(o=t==null?void 0:t.responsible_user)==null?void 0:o.username}),a.jsxs(n,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(i,{variant:"p",component:"p",fontWeight:500,children:(p=t==null?void 0:t.responsible_user)==null?void 0:p.username}),a.jsx(i,{variant:"p",component:"p",color:"var(--outline)",children:(f=t==null?void 0:t.responsible_user)==null?void 0:f.role})]})]}):a.jsx(i,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})}),a.jsx(H,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),a.jsxs(n,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(i,{variant:"p",component:"p",fontWeight:500,children:y(t==null?void 0:t.created_at_datetime)}),a.jsx(i,{variant:"p",component:"p",color:"var(--outline)",children:S(t==null?void 0:t.created_at_datetime)})]})]})})}}],[]),g=d.useMemo(()=>({row:t})=>{const s=d.useMemo(()=>[{id:"field",label:"Campo",align:"left",sortable:!0},{id:"before",label:"Antes",align:"left",sortable:!0,renderComponent:({row:e})=>(e==null?void 0:e.field)==="Descrição"&&e!=null&&e.before?a.jsx(l,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:a.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:m(e==null?void 0:e.before)})}):(e==null?void 0:e.field)==="Contacto"&&e!=null&&e.before?b(e==null?void 0:e.before):e!=null&&e.before?e==null?void 0:e.before:a.jsx(i,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"after",label:"Depois",align:"left",sortable:!0,renderComponent:({row:e})=>(e==null?void 0:e.field)==="Descrição"&&e!=null&&e.after?a.jsx(l,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:a.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:m(e==null?void 0:e.after)})}):(e==null?void 0:e.field)==="Contacto"&&e!=null&&e.after?b(e==null?void 0:e.after):e!=null&&e.after?e==null?void 0:e.after:a.jsx(i,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"changed",label:"Alterado",align:"left",sortable:!0,renderComponent:({row:e})=>a.jsx(a.Fragment,{children:e!=null&&e.changed?a.jsx(A,{color:"success"}):a.jsx(T,{color:"error"})})}],[]);return a.jsx(l,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden",margin:3},children:a.jsx(x,{data:(t==null?void 0:t.details)??[],columns:s})})},[]);return a.jsxs(D,{elevation:1,children:[a.jsx(L,{title:"Histórico de Atividades",description:"Histórico de atividades sobre o cliente",icon:a.jsx(E,{})}),a.jsx(M,{isLoading:!r,LoadingComponent:a.jsx(R,{mode:"datatable"}),LoadedComponent:a.jsx(l,{sx:{margin:3,border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:a.jsx(x,{mode:"datatable",data:r?(c=u[0])==null?void 0:c.interactions_history:[],columns:j,ExpandableContentComponent:g})})})]})};export{B as default};
