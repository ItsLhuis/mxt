import{q as Q,v as J,d as K,bd as O,r as X,j as e,ay as Y,S as W,G as r,az as a,an as d,f as c,g as p,C as z,bg as Z,B as x,L as $,t as D,s as ee,aB as se}from"./index-CeqpX1Nb.js";import{c as oe}from"./user-CwWV65hS.js";import{R as te,s as B}from"./sanitizeHTML-DKq6pAo9.js";const ae=({user:u,isLoading:A,isError:M})=>{var C,b,f,v,w,T,S,U,k,E,I,F;const i=!A&&!M,R=Q(),g=J(R.breakpoints.down("sm")),{control:j,register:h,handleSubmit:G,formState:{errors:t},reset:H,watch:l}=K({resolver:D(oe),defaultValues:{name:"",phoneNumber:"",country:"",city:"",locality:"",address:"",postalCode:"",description:""}}),{updateUserPersonalData:L,findEmployeeByUserId:P}=O(),{data:s,isLoading:V,isError:_}=P(u.id),m=!V&&!_,n={name:(s==null?void 0:s.name)||"",phoneNumber:(s==null?void 0:s.phone_number)||"",country:(s==null?void 0:s.country)||"",city:(s==null?void 0:s.city)||"",locality:(s==null?void 0:s.locality)||"",address:(s==null?void 0:s.address)||"",postalCode:(s==null?void 0:s.postal_code)||"",description:(s==null?void 0:s.description)||""},y=()=>{const o=l();return o.name===n.name&&o.phoneNumber===n.phoneNumber&&o.country===n.country&&o.city===n.city&&o.locality===n.locality&&o.address===n.address&&o.postalCode===n.postalCode&&(B(o.description)===""?"":o.description)===n.description};X.useEffect(()=>{i&&m&&u&&H(n)},[i,m,u]);const q=async o=>{!i||!m||y()||await L.mutateAsync({userId:u.id,...o,description:B(o.description)===""?null:o.description}).then(()=>ee("Dados pessoais atualizados com sucesso!")).catch(()=>se("Erro ao atualizar dados pessoais!"))};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Dados Pessoais",description:"Atualizar dados pessoais do utilizador"}),e.jsx("form",{onSubmit:G(q),children:e.jsxs(W,{sx:{paddingTop:1},children:[e.jsxs(r,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(p,{...h("name"),label:"Nome",error:!!t.name,helperText:(C=t.name)==null?void 0:C.message,InputLabelProps:{shrink:((b=l("name"))==null?void 0:b.length)>0}})})})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(z,{name:"phoneNumber",control:j,render:({field:o})=>{var N;return e.jsx(Z,{...o,value:o.value||"+351",defaultCountry:"pt",label:"Contacto",variant:"outlined",fullWidth:!0,error:!!t.phoneNumber,helperText:(N=t.phoneNumber)==null?void 0:N.message,disableDropdown:!0})}})})})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(p,{...h("country"),label:"País",error:!!t.country,helperText:(f=t.country)==null?void 0:f.message,InputLabelProps:{shrink:((v=l("country"))==null?void 0:v.length)>0}})})})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(p,{...h("city"),label:"Cidade",error:!!t.city,helperText:(w=t.city)==null?void 0:w.message,InputLabelProps:{shrink:((T=l("city"))==null?void 0:T.length)>0}})})})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(p,{...h("locality"),label:"Localidade",error:!!t.locality,helperText:(S=t.locality)==null?void 0:S.message,InputLabelProps:{shrink:((U=l("locality"))==null?void 0:U.length)>0}})})})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(W,{sx:{flexDirection:g?"column":"row",gap:2},children:[e.jsx(x,{sx:{width:"100%"},children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(p,{...h("address"),label:"Morada",error:!!t.address,helperText:(k=t.address)==null?void 0:k.message,InputLabelProps:{shrink:((E=l("address"))==null?void 0:E.length)>0}})})})}),e.jsx(x,{sx:{width:g?"100%":"60%"},children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(c,{fullWidth:!0,children:e.jsx(p,{...h("postalCode"),label:"Código Postal",error:!!t.postalCode,helperText:(I=t.postalCode)==null?void 0:I.message,InputLabelProps:{shrink:((F=l("postalCode"))==null?void 0:F.length)>0}})})})})]})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{isLoading:!i,LoadingComponent:e.jsx(d,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{name:"description",control:j,render:({field:o})=>e.jsx(te,{value:o.value,onChange:o.onChange,isLoading:!i})})})})]}),e.jsx(x,{sx:{marginLeft:"auto",padding:3},children:e.jsx($,{loading:L.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!i||!m||y(),children:"Atualizar Dados Pessoais"})})]})})]})};export{ae as default};
