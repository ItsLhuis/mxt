import{b as W,a as R,r as g,j as t,S as s,B as p,aR as j,a$ as $,aL as P,aO as J,bD as O,bE as q,aI as f,h as x,aD as v,b0 as C,aA as z,W as H,ay as N,az as V,aB as Q,aC as G}from"./index-_NktdslD.js";import{u as K}from"./Dashboard-BVDuBbso.js";import{u as U}from"./useCompany-d5GTC3bD.js";import{T as X,a as Z}from"./Tabs-B8rkhaSb.js";import"./useClient-B8aLe1Fc.js";import"./useEquipment-Dy7ZmQ0L.js";import"./useRepair-MRRzMLfz.js";import"./email-CZ5mtdVc.js";import"./sms-C6P6uXfu.js";import"./Container-C5zSTFrd.js";const tt=({children:r,value:d,index:o,...m})=>t.jsx(p,{role:"tabpanel",hidden:d!==o,id:`tab-panel-${o}`,"aria-labelledby":`tab-${o}`,...m,children:d===o&&t.jsx(s,{sx:{gap:1,margin:3,justifyContent:"center",alignItems:"center"},children:r})}),at=r=>({id:`tab-${r}`,"aria-controls":`tab-panel-${r}`}),ut=({toggleActivityYear:r})=>{const d=W(),o=R(d.breakpoints.down("sm")),[m,y]=g.useState(0),w=(a,e)=>y(e),[h,S]=g.useState(new Date().getFullYear()),{findEmployeeActivity:D,findClientActivity:A,findEquipmentActivity:T,findRepairActivity:L,findEmailActivity:_,findSmsActivity:k}=K(h),{findCompany:u}=U(),n=["rgb(248, 112, 96)","rgb(92, 107, 192)","rgb(139, 195, 74)","rgb(255, 152, 0)","rgb(33, 150, 243)","rgb(255, 87, 34)"],l=[{label:"Funcionários",icon:t.jsx(z,{sx:{color:n[0]}}),hook:D},{label:"Clientes",icon:t.jsx(H,{sx:{color:n[1]}}),hook:A},{label:"Equipamentos",icon:t.jsx(N,{sx:{color:n[2]}}),hook:T},{label:"Reparações",icon:t.jsx(V,{sx:{color:n[3]}}),hook:L},{label:"E-mails",icon:t.jsx(Q,{sx:{color:n[4]}}),hook:_},{label:"SMS",icon:t.jsx(G,{sx:{color:n[5]}}),hook:k}],b=l.reduce((a,{label:e,hook:i})=>{const{data:c,isLoading:Y,isError:M}=i;return a[e]={total:(c==null?void 0:c.total_for_year)||0,loading:Y,error:M},a},{}),E=!l.some(({hook:a})=>a.isLoading)&&!l.some(({hook:a})=>a.isError),B=l.map(({label:a,hook:e})=>{var i;return{name:a,data:((i=e.data)==null?void 0:i.totals_by_month_for_year.map(c=>c.total))||[]}}),F=u.data?Array.from({length:new Date().getFullYear()-new Date(u.data.created_at_datetime).getFullYear()+1},(a,e)=>new Date(u.data.created_at_datetime).getFullYear()+e).reverse():[],I=()=>v(Object.values(b).reduce((a,{total:e})=>a+e,0));return t.jsxs(s,{children:[t.jsxs(p,{sx:{width:"100%",padding:3,paddingTop:0},children:[t.jsx(s,{sx:{marginBlock:1,alignItems:"flex-end"},children:t.jsx(j,{isLoading:u.isLoading,LoadingComponent:t.jsx($,{variant:"rounded",height:41,width:87}),LoadedComponent:t.jsx(P,{title:h.toString(),children:t.jsx(J,{buttons:F.map(a=>({label:a.toString(),onClick:()=>{r(a),S(a)},selected:h===a}))})})})}),t.jsx(p,{sx:{width:"100%",minHeight:500,display:"flex",justifyContent:"center",alignItems:"center"},children:t.jsx(j,{isLoading:!E,LoadingComponent:t.jsx(O,{}),LoadedComponent:t.jsx(q,{data:B,categories:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],limits:[1,12],colors:n}),style:{width:"100%",minHeight:500}})})]}),t.jsx(f,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),t.jsxs(s,{sx:{flexDirection:o?"column":"row",justifyContent:"space-between"},children:[t.jsxs(s,{sx:{width:o?"100%":"60%",justifyContent:"center",alignItems:"center",paddingTop:2},children:[t.jsx(X,{value:m,onChange:w,"aria-label":"activity-tabs",variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{width:"100%","& .MuiTabs-flexContainer":{maxWidth:"fit-content",marginLeft:"auto",marginRight:"auto"}},children:l.map((a,e)=>t.jsx(Z,{label:a.label,icon:a.icon,...at(e)},e))}),l.map((a,e)=>{var i;return t.jsxs(tt,{value:m,index:e,children:[t.jsx(x,{variant:"body2",component:"p",sx:{fontWeight:600,color:"var(--outline)"},children:a.label}),t.jsxs(s,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[t.jsx(x,{variant:"h3",component:"h3",children:v(((i=b[a.label])==null?void 0:i.total)||0)}),t.jsx(C,{title:"Total acumulado ao longo do ano"})]})]},e)})]}),t.jsx(f,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),t.jsxs(s,{sx:{width:o?"100%":"40%",padding:3,gap:1,justifyContent:"center",alignItems:"center"},children:[t.jsx(x,{variant:"body2",component:"p",sx:{fontWeight:600,color:"var(--outline)"},children:"Total"}),t.jsxs(s,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[t.jsx(x,{variant:"h3",component:"h3",children:I()}),t.jsx(C,{title:"Total acumulado anual de todas as atividades"})]})]})]})]})};export{ut as default};
