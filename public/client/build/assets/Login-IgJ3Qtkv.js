var P=(t,e,o)=>{if(!e.has(t))throw TypeError("Cannot "+o)};var a=(t,e,o)=>(P(t,e,"read from private field"),o?o.call(t):e.get(t)),S=(t,e,o)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,o)},A=(t,e,o,s)=>(P(t,e,"write to private field"),s?s.call(t,o):e.set(t,o),o);var M=(t,e,o)=>(P(t,e,"access private method"),o);import{a9 as ct,aa as ut,ab as F,ac as dt,ad as tt,ae as pt,r as C,af as ht,a6 as mt,c as O,j as r,a7 as E,o as gt,z as $,ag as _,ah as H,$ as g,a2 as vt,ai as K,I as xt,a3 as ft,aj as yt,a5 as St,a as Ct,u as bt,B as q,i as R,S as V,ak as jt,m as At,F as D,e as Z,al as Mt,L as Q}from"./index-DHDdvYmK.js";import{n as It,s as wt}from"./utils-km2FGkQ4.js";import{z as T,u as Lt,t as Ot}from"./index-4PtKk4g3.js";import{a as zt}from"./axios-B4uVmeYG.js";var v,x,i,h,I,k,L,B,Y,kt=(Y=class extends ct{constructor(e,o){super();S(this,I);S(this,L);S(this,v,void 0);S(this,x,void 0);S(this,i,void 0);S(this,h,void 0);A(this,v,e),this.setOptions(o),this.bindMethods(),M(this,I,k).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var s;const o=this.options;this.options=a(this,v).defaultMutationOptions(e),ut(this.options,o)||a(this,v).getMutationCache().notify({type:"observerOptionsUpdated",mutation:a(this,i),observer:this}),o!=null&&o.mutationKey&&this.options.mutationKey&&F(o.mutationKey)!==F(this.options.mutationKey)?this.reset():((s=a(this,i))==null?void 0:s.state.status)==="pending"&&a(this,i).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=a(this,i))==null||e.removeObserver(this)}onMutationUpdate(e){M(this,I,k).call(this),M(this,L,B).call(this,e)}getCurrentResult(){return a(this,x)}reset(){var e;(e=a(this,i))==null||e.removeObserver(this),A(this,i,void 0),M(this,I,k).call(this),M(this,L,B).call(this)}mutate(e,o){var s;return A(this,h,o),(s=a(this,i))==null||s.removeObserver(this),A(this,i,a(this,v).getMutationCache().build(a(this,v),this.options)),a(this,i).addObserver(this),a(this,i).execute(e)}},v=new WeakMap,x=new WeakMap,i=new WeakMap,h=new WeakMap,I=new WeakSet,k=function(){var o;const e=((o=a(this,i))==null?void 0:o.state)??dt();A(this,x,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},L=new WeakSet,B=function(e){tt.batch(()=>{var o,s,n,l,c,p,f,y;if(a(this,h)&&this.hasListeners()){const u=a(this,x).variables,d=a(this,x).context;(e==null?void 0:e.type)==="success"?((s=(o=a(this,h)).onSuccess)==null||s.call(o,e.data,u,d),(l=(n=a(this,h)).onSettled)==null||l.call(n,e.data,null,u,d)):(e==null?void 0:e.type)==="error"&&((p=(c=a(this,h)).onError)==null||p.call(c,e.error,u,d),(y=(f=a(this,h)).onSettled)==null||y.call(f,void 0,e.error,u,d))}this.listeners.forEach(u=>{u(a(this,x))})})},Y);function Et(t,e){const o=pt(),[s]=C.useState(()=>new kt(o,t));C.useEffect(()=>{s.setOptions(t)},[s,t]);const n=C.useSyncExternalStore(C.useCallback(c=>s.subscribe(tt.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=C.useCallback((c,p)=>{s.mutate(c,p).catch(It)},[s]);if(n.error&&wt(s.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}function Pt(t){return mt("MuiAlert",t)}const G=ht("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Rt=O(r.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),Tt=O(r.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),$t=O(r.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),Bt=O(r.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined"),Nt=O(r.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),Ut=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],Wt=yt(),Ft=t=>{const{variant:e,color:o,severity:s,classes:n}=t,l={root:["root",`color${$(o||s)}`,`${e}${$(o||s)}`,`${e}`],icon:["icon"],message:["message"],action:["action"]};return St(l,Pt,n)},_t=E(gt,{name:"MuiAlert",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:o}=t;return[e.root,e[o.variant],e[`${o.variant}${$(o.color||o.severity)}`]]}})(({theme:t})=>{const e=t.palette.mode==="light"?_:H,o=t.palette.mode==="light"?H:_;return g({},t.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(([,s])=>s.main&&s.light).map(([s])=>({props:{colorSeverity:s,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${s}Color`]:e(t.palette[s].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${s}StandardBg`]:o(t.palette[s].light,.9),[`& .${G.icon}`]:t.vars?{color:t.vars.palette.Alert[`${s}IconColor`]}:{color:t.palette[s].main}}})),...Object.entries(t.palette).filter(([,s])=>s.main&&s.light).map(([s])=>({props:{colorSeverity:s,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${s}Color`]:e(t.palette[s].light,.6),border:`1px solid ${(t.vars||t).palette[s].light}`,[`& .${G.icon}`]:t.vars?{color:t.vars.palette.Alert[`${s}IconColor`]}:{color:t.palette[s].main}}})),...Object.entries(t.palette).filter(([,s])=>s.main&&s.dark).map(([s])=>({props:{colorSeverity:s,variant:"filled"},style:g({fontWeight:t.typography.fontWeightMedium},t.vars?{color:t.vars.palette.Alert[`${s}FilledColor`],backgroundColor:t.vars.palette.Alert[`${s}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[s].dark:t.palette[s].main,color:t.palette.getContrastText(t.palette[s].main)})}))]})}),Ht=E("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(t,e)=>e.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Kt=E("div",{name:"MuiAlert",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),J=E("div",{name:"MuiAlert",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),X={success:r.jsx(Rt,{fontSize:"inherit"}),warning:r.jsx(Tt,{fontSize:"inherit"}),error:r.jsx($t,{fontSize:"inherit"}),info:r.jsx(Bt,{fontSize:"inherit"})},qt=C.forwardRef(function(e,o){const s=Wt({props:e,name:"MuiAlert"}),{action:n,children:l,className:c,closeText:p="Close",color:f,components:y={},componentsProps:u={},icon:d,iconMapping:z=X,onClose:b,role:U="alert",severity:j="success",slotProps:et={},slots:st={},variant:ot="standard"}=s,rt=vt(s,Ut),m=g({},s,{color:f,severity:j,variant:ot,colorSeverity:f||j}),w=Ft(m),W={slots:g({closeButton:y.CloseButton,closeIcon:y.CloseIcon},st),slotProps:g({},u,et)},[at,nt]=K("closeButton",{elementType:xt,externalForwardedProps:W,ownerState:m}),[it,lt]=K("closeIcon",{elementType:Nt,externalForwardedProps:W,ownerState:m});return r.jsxs(_t,g({role:U,elevation:0,ownerState:m,className:ft(w.root,c),ref:o},rt,{children:[d!==!1?r.jsx(Ht,{ownerState:m,className:w.icon,children:d||z[j]||X[j]}):null,r.jsx(Kt,{ownerState:m,className:w.message,children:l}),n!=null?r.jsx(J,{ownerState:m,className:w.action,children:n}):null,n==null&&b?r.jsx(J,{ownerState:m,className:w.action,children:r.jsx(at,g({size:"small","aria-label":p,title:p,color:"inherit",onClick:b},nt,{children:r.jsx(it,g({fontSize:"small"},lt))}))}):null]}))}),Vt="http://localhost:8080/api/v1",N=zt.create({baseURL:Vt});N.interceptors.response.use(t=>t,t=>{var o;const e=((o=t.response)==null?void 0:o.data)||"An unexpected error occurred.";return Promise.reject(e)});const Dt=async({username:t,password:e})=>{const o=await N.post("/auth/login",{username:t,password:e}),{refreshToken:s,accessToken:n}=o.data;return document.cookie=`refreshToken=${s}; Path=/; Secure; SameSite=None`,document.cookie=`accessToken=${n}; Path=/; Secure; SameSite=None`,o.data},Zt=async()=>(await N.get("/company")).data,Qt=T.object({username:T.string().trim().min(1,{message:"O nome de utilizador é obrigatório"}),password:T.string().trim().min(1,{message:"A senha é obrigatória"})}),ee=()=>{var d,z;const[t,e]=C.useState(""),{register:o,handleSubmit:s,setFocus:n,formState:{errors:l}}=Lt({resolver:Ot(Qt)}),{mutateAsync:c,isPending:p}=Et({mutationFn:async b=>(await new Promise(j=>setTimeout(j,500)),await Dt(b))}),f=Ct(),{showLoader:y}=bt(),u=async b=>{await c(b).then(()=>{y(),setTimeout(()=>{f("/")},200)}).catch(()=>{n("username"),e("Nome de utilizador ou senha inválidos!")})};return r.jsxs(q,{children:[r.jsx(R,{variant:"h3",component:"h3",sx:{marginBottom:4,fontSize:"2.5rem !important"},children:"Mixtech"}),r.jsx(V,{sx:{gap:2,marginBottom:4},children:r.jsxs(jt,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[r.jsx(R,{variant:"h4",component:"h4",children:"Iniciar Sessão"}),r.jsx(R,{variant:"p",component:"p",children:"Bem vindo de volta!"})]})}),t&&r.jsx(At.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2},children:r.jsx(q,{sx:{marginBottom:6},children:r.jsx(qt,{severity:"error",elevation:1,children:t})})}),r.jsx("form",{onSubmit:s(u),children:r.jsxs(V,{sx:{gap:2},children:[r.jsx(D,{fullWidth:!0,children:r.jsx(Z,{...o("username"),label:"Nome de utilizador",error:!!l.username,helperText:(d=l.username)==null?void 0:d.message,autoComplete:"username"})}),r.jsx(D,{fullWidth:!0,children:r.jsx(Z,{...o("password"),type:"password",label:"Senha",error:!!l.password,helperText:(z=l.password)==null?void 0:z.message,autoComplete:"current-password"})}),r.jsx(Mt,{sx:{alignSelf:"flex-end",fontSize:"13px",margin:"8px 0",color:"inherit",textDecorationColor:"inherit"},children:"Esqueceu a sua senha?"}),r.jsx(Q,{loading:p,type:"submit",variant:"contained",children:"Iniciar Sessão"})]})}),r.jsx(Q,{variant:"contained",onClick:()=>{Zt()},children:"Request"})]})};export{ee as default};
