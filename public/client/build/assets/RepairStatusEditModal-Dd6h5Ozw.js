import{r as i,j as o,aT as C,S as F,bA as y,F as P,T as k,aj as w,s as I}from"./index-mWc9gLhA.js";import{u as v,b as z,C as A,t as M}from"./index-COzNbWAj.js";import{a as N}from"./repair-D-n4dckQ.js";import{u as V}from"./useRepair-BcwC0uik.js";const W=({status:e,open:a,onClose:t})=>{var u,d;const s=i.useRef(null);i.useEffect(()=>{if(!a)return;const r=setTimeout(()=>{a&&s.current&&s.current.focus()},100);return()=>clearTimeout(r)},[a]);const{control:m,register:p,handleSubmit:h,getValues:x,formState:{errors:l},setError:E,reset:n}=v({resolver:M(N)}),S={color:(e==null?void 0:e.color)||"default",name:(e==null?void 0:e.name)||""},{isDirty:b}=z({control:m}),c=()=>!b;i.useEffect(()=>{e&&n(S)},[e]);const{updateRepairStatus:g}=V(),j=async r=>{if(!c())return new Promise((T,f)=>{g.mutateAsync({statusId:e.id,...r}).then(()=>{t(),w("Estado atualizado com sucesso!"),n(),T()}).catch(R=>{if(R.error.code==="REP-007"){E("name",{type:"manual",message:"Nome jÃ¡ existente"}),f();return}t(),I("Erro ao atualizar estado!"),n(),f()})})};return o.jsx(C,{mode:"form",title:"Editar Estado",open:a,onClose:t,submitButtonText:"Editar Estado",onSubmit:h(j),disabled:c(),children:o.jsxs(F,{sx:{padding:3,gap:2},children:[o.jsx(A,{name:"color",control:m,render:({field:r})=>o.jsx(y,{label:"Cor",selected:r.value,onChange:r.onChange})}),o.jsx(P,{fullWidth:!0,children:o.jsx(k,{...p("name"),label:"Nome",error:!!l.name,helperText:(u=l.name)==null?void 0:u.message,autoComplete:"off",inputRef:s,InputLabelProps:{shrink:((d=x("name"))==null?void 0:d.length)>0}})})]})})};export{W as default};
