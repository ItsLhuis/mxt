import{r as l,p as F,j as e,f as R,H as x,B as S,ba as v,aU as A,S as B,F as u,T as c,ak as U,s as g}from"./index-_NktdslD.js";import{u as k,t as M}from"./index-8QsUXVhp.js";import{u as W}from"./user-g_Xt_bPI.js";import{a as H}from"./Settings-DBUuu7F2.js";import"./isPossiblePhoneNumber-DES16dOz.js";import"./Container-C5zSTFrd.js";import"./Tabs-B8rkhaSb.js";const G=()=>{var m,h,f;const{register:o,handleSubmit:j,formState:{errors:s},setError:P,reset:T}=k({resolver:M(W)}),[t,r]=l.useState(!1),n=l.useRef(null);l.useEffect(()=>{if(!t){T();return}const i=setTimeout(()=>{t&&n.current&&n.current.focus()},100);return()=>clearTimeout(i)},[t]);const{findUserProfile:a,updateUserPassword:b}=F(),p=!a.isLoading&&!a.isError,y=async i=>new Promise((C,d)=>{var w;p?b.mutateAsync({userId:(w=a==null?void 0:a.data)==null?void 0:w.id,...i}).then(()=>{r(!1),U("Senha alterada com sucesso!"),C()}).catch(E=>{if(E.error.code==="USR-005"){P("password",{type:"manual",message:"Senha atual incorreta"}),d();return}r(!1),g("Erro ao alterar senha!"),d()}):(r(!1),g("Erro ao alterar senha!"),d())});return e.jsxs(e.Fragment,{children:[e.jsxs(R,{elevation:1,children:[e.jsx(x,{title:"Segurança",description:"Definições de Segurança",icon:e.jsx(H,{})}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:2,paddingBottom:2,paddingRight:3},children:[e.jsx(x,{title:"Senha",description:"Altere a sua senha"}),e.jsx(S,{sx:{paddingTop:2},children:e.jsx(v,{variant:"contained",color:"error",disabled:!p,onClick:()=>r(!0),children:"Alterar Senha"})})]})]}),e.jsx(A,{open:t,onClose:()=>r(!1),mode:"form",title:"Alterar Senha",submitButtonText:"Alterar Senha",color:"error",onSubmit:j(y),children:e.jsxs(B,{sx:{padding:3,gap:2},children:[e.jsx(u,{fullWidth:!0,children:e.jsx(c,{inputRef:n,...o("password"),type:"password",label:"Senha atual",error:!!s.password,helperText:(m=s.password)==null?void 0:m.message,autoComplete:"current-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...o("newPassword"),type:"password",label:"Nova senha",error:!!s.newPassword,helperText:(h=s.newPassword)==null?void 0:h.message,autoComplete:"new-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...o("confirmPassword"),type:"password",label:"Confirmar nova senha",error:!!s.confirmPassword,helperText:(f=s.confirmPassword)==null?void 0:f.message,autoComplete:"new-password"})})]})})]})};export{G as default};
