import{X as E,r as l,b as R,j as e,a as v,az as f,B as S,ae as A,ay as B,Z as F,$ as u,a0 as c,a3 as z,a9 as U,a4 as g}from"./index-DjYwzy8o.js";import{u as M}from"./user-B-uUes6W.js";import{a as W}from"./Settings-DxnV3oU_.js";import"./Container-FxE9Zhx2.js";const L=()=>{var h,m,w;const{register:t,handleSubmit:j,formState:{errors:s},setError:P}=E({resolver:z(M)}),[o,a]=l.useState(!1),n=l.useRef(null);l.useEffect(()=>{const i=setTimeout(()=>{o&&n.current&&n.current.focus()},100);return()=>clearTimeout(i)},[o]);const{findUserProfile:r,updateUserPassword:b}=R(),p=!r.isLoading&&!r.isError,y=async i=>new Promise((T,d)=>{var x;p?b.mutateAsync({userId:(x=r==null?void 0:r.data)==null?void 0:x.id,...i}).then(()=>{a(!1),U("Senha atualizada com sucesso!"),T()}).catch(C=>{if(C.error.code==="USR-005"){P("password",{type:"manual",message:"Senha atual incorreta"}),d();return}a(!1),g("Erro ao atualizar senha!"),d()}):(a(!1),g("Erro ao atualizar senha!"),d())});return e.jsxs(e.Fragment,{children:[e.jsxs(v,{elevation:1,children:[e.jsx(f,{title:"Segurança",description:"Definições de Segurança",icon:e.jsx(W,{})}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:2,paddingBottom:2,paddingRight:3},children:[e.jsx(f,{title:"Senha",description:"Altere a sua senha"}),e.jsx(S,{sx:{paddingTop:2},children:e.jsx(A,{variant:"contained",color:"error",disabled:!p,onClick:()=>a(!0),children:"Alterar Senha"})})]})]}),e.jsx(B,{open:o,onClose:()=>a(!1),mode:"form",title:"Alterar Senha",submitButtonText:"Alterar Senha",color:"error",onSubmit:j(y),children:e.jsxs(F,{sx:{padding:3,gap:2},children:[e.jsx(u,{fullWidth:!0,children:e.jsx(c,{inputRef:n,...t("password"),type:"password",label:"Senha atual",error:!!s.password,helperText:(h=s.password)==null?void 0:h.message,autoComplete:"current-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...t("newPassword"),type:"password",label:"Nova senha",error:!!s.newPassword,helperText:(m=s.newPassword)==null?void 0:m.message,autoComplete:"new-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...t("confirmPassword"),type:"password",label:"Confirmar nova senha",error:!!s.confirmPassword,helperText:(w=s.confirmPassword)==null?void 0:w.message,autoComplete:"new-password"})})]})})]})};export{L as default};
