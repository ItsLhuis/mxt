import{r as u,j as t,a$ as z,B as F,F as I,T as y,aj as w,s as B}from"./index-QasZhORg.js";import{u as P,b as M,t as N}from"./index-CO9l3Whn.js";import{o as V}from"./repair-zwE_KJbM.js";import{u as A}from"./useRepair-CKNzoFdU.js";import"./repair-wd4kSyCe.js";const G=({interventionWorkDone:a,open:e,onClose:r})=>{var n,c;const s=u.useRef(null);u.useEffect(()=>{if(!e)return;const m=setTimeout(()=>{e&&s.current&&s.current.focus()},100);return()=>clearTimeout(m)},[e]);const{control:f,register:h,handleSubmit:p,getValues:x,formState:{errors:i},setError:b,reset:o}=P({resolver:N(V)}),E={name:(a==null?void 0:a.name)||""},{isDirty:T}=M({control:f}),l=()=>!T;u.useEffect(()=>{a&&o(E)},[a]);const{updateInterventionWorkDone:R}=A(),g=async m=>{if(!l())return new Promise((j,d)=>{R.mutateAsync({interventionWorkDoneId:a.id,...m}).then(()=>{r(),w("Trabalho realizado atualizado com sucesso!"),o(),j()}).catch(S=>{if(S.error.code==="REP-016"){b("name",{type:"manual",message:"Nome jÃ¡ existente"}),d();return}r(),B("Erro ao atualizar trabalho realizado!"),o(),d()})})};return t.jsx(z,{mode:"form",title:"Editar Trabalho Realizado",open:e,onClose:r,submitButtonText:"Editar Trabalho Realizado",onSubmit:p(g),disabled:l(),children:t.jsx(F,{sx:{padding:3},children:t.jsx(I,{fullWidth:!0,children:t.jsx(y,{...h("name"),label:"Nome",error:!!i.name,helperText:(n=i.name)==null?void 0:n.message,autoComplete:"off",inputRef:s,InputLabelProps:{shrink:((c=x("name"))==null?void 0:c.length)>0}})})})})};export{G as default};
