import{r as i,j as o,aU as C,S as F,bA as k,F as y,T as P,ak as w,s as I}from"./index-_NktdslD.js";import{u as v,b as z,C as A,t as M}from"./index-8QsUXVhp.js";import{a as N}from"./repair-j_MUsWAD.js";import{u as U}from"./useRepair-MRRzMLfz.js";const W=({status:e,open:a,onClose:t})=>{var u,d;const s=i.useRef(null);i.useEffect(()=>{if(!a)return;const r=setTimeout(()=>{a&&s.current&&s.current.focus()},100);return()=>clearTimeout(r)},[a]);const{control:m,register:p,handleSubmit:h,getValues:x,formState:{errors:l},setError:E,reset:n}=v({resolver:M(N)}),S={color:(e==null?void 0:e.color)||"default",name:(e==null?void 0:e.name)||""},{isDirty:b}=z({control:m}),c=()=>!b;i.useEffect(()=>{e&&n(S)},[e]);const{updateRepairStatus:g}=U(),j=async r=>{if(!c())return new Promise((R,f)=>{g.mutateAsync({statusId:e.id,...r}).then(()=>{t(),w("Estado atualizado com sucesso!"),n(),R()}).catch(T=>{if(T.error.code==="REP-007"){E("name",{type:"manual",message:"Nome jÃ¡ existente"}),f();return}t(),I("Erro ao atualizar estado!"),n(),f()})})};return o.jsx(C,{mode:"form",title:"Editar Estado",open:a,onClose:t,submitButtonText:"Editar Estado",onSubmit:h(j),disabled:c(),children:o.jsxs(F,{sx:{padding:3,gap:2},children:[o.jsx(A,{name:"color",control:m,render:({field:r})=>o.jsx(k,{label:"Cor",selected:r.value,onChange:r.onChange})}),o.jsx(y,{fullWidth:!0,children:o.jsx(P,{...p("name"),label:"Nome",error:!!l.name,helperText:(u=l.name)==null?void 0:u.message,autoComplete:"off",inputRef:s,InputLabelProps:{shrink:((d=x("name"))==null?void 0:d.length)>0}})})]})})};export{W as default};
