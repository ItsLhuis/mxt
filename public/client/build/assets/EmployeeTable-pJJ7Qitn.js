import{d as I,e as A,q as L,r as p,j as a,S as s,aZ as b,a_ as h,h as n,aG as f,a$ as T,aE as z,aF as B,ax as O,aH as $,aj as F,ay as k,b0 as P,f as U,B as W,aM as N,b1 as q,aC as R,b2 as G}from"./index-C9HasOiM.js";import{f as H}from"./phone-CfgKBj3V.js";import{M as V}from"./MoreVert-CDz2P5kD.js";import{E as Z}from"./Edit-CYRFZ1bJ.js";import"./isPossiblePhoneNumber-C2Df4Gz7.js";const w=()=>{const j=I(),{id:u,role:g}=A(),{findAllEmployees:y,deleteEmployee:_}=L(),{data:c,isLoading:C}=y,[m,x]=p.useState({isOpen:!1,userId:null}),S=e=>{x({isOpen:!0,userId:e})},o=()=>{x({isOpen:!1,userId:null})},E=()=>new Promise((e,t)=>{m.userId?_.mutateAsync({userId:m.userId}).then(()=>{o(),e()}).catch(()=>{o(),t()}):(o(),t())}),D=p.useMemo(()=>c?c.filter(e=>e.user.id!==u):[],[c,u]),M=p.useMemo(()=>[{id:"user.username",label:"Utilizador",align:"left",sortable:!0,renderComponent:({row:e})=>{var t,l,i,d,r;return a.jsxs(s,{sx:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:1},children:[a.jsx(b,{alt:(t=e==null?void 0:e.user)==null?void 0:t.username,src:`${h}/users/${(l=e==null?void 0:e.user)==null?void 0:l.id}/avatar?size=80`,name:(i=e==null?void 0:e.user)==null?void 0:i.username}),a.jsxs(s,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(n,{variant:"p",component:"p",fontWeight:500,children:(d=e==null?void 0:e.user)==null?void 0:d.username}),a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:(r=e==null?void 0:e.user)==null?void 0:r.role})]})]})}},{id:"user.is_active",label:"Estado",align:"left",sortable:!0,renderComponent:({row:e})=>{var t;return a.jsx(a.Fragment,{children:(t=e==null?void 0:e.user)!=null&&t.is_active?a.jsx(f,{color:"success",label:"Ativo"}):a.jsx(f,{color:"error",label:"Inativo"})})}},{id:"name",label:"Nome",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.name?e==null?void 0:e.name:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"user.email",label:"E-mail",align:"left",sortable:!0,renderComponent:({row:e})=>{var t,l;return(t=e==null?void 0:e.user)!=null&&t.email?(l=e==null?void 0:e.user)==null?void 0:l.email:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})}},{id:"phone_number",label:"Contacto",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.phone_number?H(e==null?void 0:e.phone_number):a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"country",label:"País",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.country?e==null?void 0:e.country:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"city",label:"Cidade",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.city?e==null?void 0:e.city:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"locality",label:"Localidade",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.locality?e==null?void 0:e.locality:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"address",label:"Morada",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.address?e==null?void 0:e.address:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"postal_code",label:"Código postal",align:"left",sortable:!0,renderComponent:({row:e})=>e!=null&&e.postal_code?e==null?void 0:e.postal_code:a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"created_by_user",visible:!1},{id:"created_at_datetime",label:"Criado por",align:"left",sortable:!0,renderComponent:({row:e})=>{var t,l,i,d,r,v;return a.jsx(a.Fragment,{children:((t=e==null?void 0:e.user)==null?void 0:t.role)!=="Chefe"&&(e!=null&&e.created_by_user)?a.jsxs(s,{sx:{flexDirection:"row",gap:2},children:[a.jsx(s,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:e!=null&&e.created_by_user?a.jsxs(a.Fragment,{children:[a.jsx(b,{alt:(l=e==null?void 0:e.created_by_user)==null?void 0:l.username,src:`${h}/users/${(i=e==null?void 0:e.created_by_user)==null?void 0:i.id}/avatar?size=80`,name:(d=e==null?void 0:e.created_by_user)==null?void 0:d.username}),a.jsxs(s,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(n,{variant:"p",component:"p",fontWeight:500,children:(r=e==null?void 0:e.created_by_user)==null?void 0:r.username}),a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:(v=e==null?void 0:e.created_by_user)==null?void 0:v.role})]})]}):a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})}),a.jsx(T,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),a.jsxs(s,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(n,{variant:"p",component:"p",fontWeight:500,children:z(e==null?void 0:e.created_at_datetime)}),a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:B(e==null?void 0:e.created_at_datetime)})]})]}):a.jsx(n,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})})}},{id:"more_options",align:"right",sortable:!1,renderComponent:({row:e})=>(e==null?void 0:e.user.role)!=="Chefe"&&!(g==="Administrador"&&(e==null?void 0:e.user.role)==="Administrador")?a.jsx(O,{mode:"custom",customButton:a.jsx($,{title:"Mais opções",sx:{margin:-1},children:a.jsx(F,{children:a.jsx(V,{})})}),children:a.jsx(k,{buttons:[{label:"Editar",icon:a.jsx(Z,{fontSize:"small"}),onClick:()=>{var t;return j(`/employee/${(t=e==null?void 0:e.user)==null?void 0:t.id}`)}},{label:"Eliminar",icon:a.jsx(P,{fontSize:"small",color:"error"}),color:"error",divider:!0,onClick:()=>{var t;return S((t=e==null?void 0:e.user)==null?void 0:t.id)}}]})}):null}],[]);return a.jsx(U,{elevation:1,children:a.jsxs(W,{sx:{marginTop:3},children:[a.jsx(N,{isLoading:C,LoadingComponent:a.jsx(q,{mode:"datatable"}),LoadedComponent:a.jsx(R,{mode:"datatable",data:D??[],columns:M})}),a.jsx(G,{mode:"delete",title:"Eliminar Funcionário",open:m.isOpen,onClose:o,onSubmit:E,description:"Tem a certeza que deseja eliminar este funcionário?",subDescription:"Ao eliminar este funcionário, os dados serão removidos de forma permanente."})]})})};export{w as default};
