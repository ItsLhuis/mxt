import{X as w,r as F,b as T,j as e,az as y,Z as A,ac as o,aw as j,ao as f,$ as L,a0 as b,B as k,a2 as v,a3 as P,a9 as B,a4 as I}from"./index-DjYwzy8o.js";import{i as R}from"./user-B-uUes6W.js";const W=({user:a,isLoading:S,isError:z})=>{var u,h,x,p;const s=!S&&!z,{register:l,handleSubmit:C,formState:{errors:t},setError:d,reset:E,watch:i}=w({resolver:P(R),defaultValues:{username:"",email:""}}),r={username:(a==null?void 0:a.username)||"",email:(a==null?void 0:a.email)||""},m=()=>{const n=i();return n.username===r.username&&n.email===r.email};F.useEffect(()=>{s&&a&&E(r)},[s,a]);const{updateUserProfile:c}=T(),U=async n=>{!s||m()||await c.mutateAsync(n).then(()=>B("Conta atualizada com sucesso!")).catch(g=>{g.error.code==="USR-001"?d("username",{type:"manual",message:"Nome de utilizador já existente"}):g.error.code==="USR-002"?d("email",{type:"manual",message:"E-mail já existente"}):I("Erro ao atualizar conta!")})};return e.jsxs(e.Fragment,{children:[e.jsx(y,{title:"Conta",description:"Atualizar dados da conta do utilizador"}),e.jsx("form",{onSubmit:C(U),children:e.jsxs(A,{sx:{paddingTop:1},children:[e.jsxs(o,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(j,{isLoading:!s,LoadingComponent:e.jsx(f,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(L,{fullWidth:!0,children:e.jsx(b,{...l("username"),label:"Nome de utilizador",error:!!t.username,helperText:(u=t.username)==null?void 0:u.message,InputLabelProps:{shrink:((h=i("username"))==null?void 0:h.length)>0}})})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(j,{isLoading:!s,LoadingComponent:e.jsx(f,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(L,{fullWidth:!0,children:e.jsx(b,{...l("email"),label:"E-mail",error:!!t.email,helperText:(x=t.email)==null?void 0:x.message,InputLabelProps:{shrink:((p=i("email"))==null?void 0:p.length)>0}})})})})]}),e.jsx(k,{sx:{marginLeft:"auto",padding:3},children:e.jsx(v,{loading:c.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!s||m(),children:"Atualizar Conta"})})]})})]})};export{W as default};
