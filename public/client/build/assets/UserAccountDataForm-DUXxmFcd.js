import{r as y,p as k,j as e,H as w,S as A,G as o,aR as p,a$ as g,F as f,T as j,B as v,L as P,ak as R,s as B}from"./index-_NktdslD.js";import{u as I,b as D,t as G}from"./index-8QsUXVhp.js";import{i as H}from"./user-g_Xt_bPI.js";import"./isPossiblePhoneNumber-DES16dOz.js";const q=({user:a,isLoading:L,isError:S})=>{var m,c,u,x;const t=!L&&!S,{control:b,register:i,handleSubmit:C,getValues:n,formState:{errors:s},setError:r,reset:F}=I({resolver:G(H)}),E={username:(a==null?void 0:a.username)||"",email:(a==null?void 0:a.email)||""},{isDirty:U}=D({control:b}),l=()=>!U;y.useEffect(()=>{t&&a&&F(E)},[t,a]);const{updateUserProfile:d}=k(),z=async T=>{!t||l()||await d.mutateAsync(T).then(()=>R("Conta atualizada com sucesso!")).catch(h=>{h.error.code==="USR-001"?r("username",{type:"manual",message:"Nome de utilizador já existente"}):h.error.code==="USR-002"?r("email",{type:"manual",message:"E-mail já existente"}):B("Erro ao atualizar conta!")})};return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"Conta",description:"Atualizar dados da conta do utilizador"}),e.jsx("form",{onSubmit:C(z),children:e.jsxs(A,{sx:{paddingTop:1},children:[e.jsxs(o,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(p,{isLoading:!t,LoadingComponent:e.jsx(g,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(f,{fullWidth:!0,children:e.jsx(j,{...i("username"),label:"Nome de utilizador",error:!!s.username,helperText:(m=s.username)==null?void 0:m.message,autoComplete:"off",InputLabelProps:{shrink:((c=n("username"))==null?void 0:c.length)>0}})})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(p,{isLoading:!t,LoadingComponent:e.jsx(g,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(f,{fullWidth:!0,children:e.jsx(j,{...i("email"),label:"E-mail",error:!!s.email,helperText:(u=s.email)==null?void 0:u.message,autoComplete:"off",InputLabelProps:{shrink:((x=n("email"))==null?void 0:x.length)>0}})})})})]}),e.jsx(v,{sx:{marginLeft:"auto",padding:3},children:e.jsx(P,{loading:d.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!t||l(),children:"Atualizar Conta"})})]})})]})};export{q as default};
