import{r,j as e,S as n,aZ as g,a_ as _,h as t,a$ as C,aE as S,aF as y,B as o,ba as p,aN as x,bb as H,aC as d,f as T,H as F,aM as M,b1 as D}from"./index-C9HasOiM.js";import{C as I}from"./Check-DBclaca9.js";import{P as z,I as A,Q as E}from"./QuestionMark-s6e7ONVZ.js";import{H as L}from"./History-BDnjiCRC.js";const W=({equipment:b,isLoading:u,isError:h})=>{const f=!u&&!h,j=r.useMemo(()=>[{id:"type",label:"Atividade",align:"left",sortable:!0},{id:"responsible_user",label:"Responsável",align:"left",sortable:!1,renderComponent:({row:a})=>{var l,s,i,c,m;return e.jsx(e.Fragment,{children:a!=null&&a.responsible_user?e.jsxs(n,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(n,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(g,{alt:(l=a==null?void 0:a.responsible_user)==null?void 0:l.username,src:`${_}/users/${(s=a==null?void 0:a.responsible_user)==null?void 0:s.id}/avatar?size=80`,name:(i=a==null?void 0:a.responsible_user)==null?void 0:i.username}),e.jsxs(n,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:(c=a==null?void 0:a.responsible_user)==null?void 0:c.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:(m=a==null?void 0:a.responsible_user)==null?void 0:m.role})]})]}),e.jsx(C,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(n,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:S(a==null?void 0:a.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:y(a==null?void 0:a.created_at_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})})}}],[]),v=r.useMemo(()=>({row:a})=>{const l=r.useMemo(()=>[{id:"field",label:"Campo",align:"left",sortable:!0},{id:"before",label:"Antes",align:"left",sortable:!0,renderComponent:({row:i})=>i.field==="Descrição"&&i.before?e.jsx(o,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:p(i.before)})}):i.field==="Cliente"&&i.before?e.jsxs(n,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[i.before.name,i.before.description&&e.jsx(x,{fontSize:"small",title:i.before.description})]}):i.field==="Tipo"&&i.before?e.jsx(e.Fragment,{children:i.before.name}):i.field==="Marca"&&i.before?e.jsx(e.Fragment,{children:i.before.name}):i.field==="Modelo"&&i.before?e.jsx(e.Fragment,{children:i.before.name}):i.before?i.before:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"after",label:"Depois",align:"left",sortable:!0,renderComponent:({row:i})=>i.field==="Descrição"&&i.after?e.jsx(o,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:p(i.after)})}):i.field==="Cliente"&&i.after?e.jsxs(n,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[i.after.name,i.after.description&&e.jsx(x,{fontSize:"small",title:i.after.description})]}):i.field==="Tipo"&&i.after?e.jsx(e.Fragment,{children:i.after.name}):i.field==="Marca"&&i.after?e.jsx(e.Fragment,{children:i.after.name}):i.field==="Modelo"&&i.after?e.jsx(e.Fragment,{children:i.after.name}):i.after?i.after:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"changed",label:"Alterado",align:"left",sortable:!0,renderComponent:({row:i})=>e.jsx(e.Fragment,{children:i.changed?e.jsx(I,{color:"success"}):e.jsx(H,{color:"error"})})}],[]),s=r.useMemo(()=>[{id:"file_mime_type",label:"Tipo",align:"left",sortable:!0,renderComponent:({row:i})=>e.jsx(n,{sx:{alignItems:"flex-start"},children:i.file_mime_type==="application/pdf"?e.jsx(z,{fontSize:"medium",sx:{color:"rgb(223, 88, 84)"}}):i.file_mime_type.startsWith("image/")?e.jsx(A,{fontSize:"medium",sx:{color:"rgb(245, 128, 8)"}}):e.jsx(E,{fontSize:"medium",sx:{color:"var(--outline)"}})})},{id:"original_filename",label:"Ficheiro",align:"left",sortable:!0,renderComponent:({row:i})=>e.jsxs(n,{children:[e.jsx(t,{variant:"p",component:"p",children:i.original_filename}),e.jsx(t,{variant:"p",component:"p",sx:{color:"var(--outline)"},children:`${i.file_size<1024*1024?(i.file_size/1024).toFixed(2)+" Kb":(i.file_size/(1024*1024)).toFixed(2)+" Mb"}`})]})}],[]);return e.jsx(o,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden",margin:3},children:a.details[0].field==="Anexos"?e.jsx(e.Fragment,{children:a.details[0].after?e.jsx(d,{data:a.details[0].after??[],columns:s}):e.jsx(d,{showSearch:!1,data:[a.details[0].before],columns:s})}):e.jsx(d,{data:a.details??[],columns:l})})},[]);return e.jsxs(T,{elevation:1,children:[e.jsx(F,{title:"Histórico de Atividades",description:"Histórico de atividades sobre o equipamento",icon:e.jsx(L,{})}),e.jsx(M,{isLoading:!f,LoadingComponent:e.jsx(D,{mode:"datatable"}),LoadedComponent:e.jsx(o,{sx:{margin:3,border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:e.jsx(d,{mode:"datatable",data:f?b[0].interactions_history:[],columns:j,ExpandableContentComponent:v})})})]})};export{W as default};
