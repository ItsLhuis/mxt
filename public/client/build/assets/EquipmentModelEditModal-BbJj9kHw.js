import{r as f,j as a,b2 as k,S as y,aM as B,aQ as N,F as S,b4 as V,T as z,ab as A,s as P}from"./index-C9HasOiM.js";import{u as Q,b as U,C as W,t as D}from"./index-BTi6rd4V.js";import{m as G}from"./equipment-D4V42Xnu.js";import{u as H}from"./useEquipment-ClzBGdbo.js";import"./equipment-DQ8Bx2dX.js";const Z=({model:e,open:s,onClose:d})=>{var h,x,g;const u=f.useRef(null);f.useEffect(()=>{if(!s)return;const r=setTimeout(()=>{s&&u.current&&u.current.focus()},100);return()=>clearTimeout(r)},[s]);const{control:p,register:M,handleSubmit:T,getValues:I,formState:{errors:o},setError:L,reset:C}=Q({resolver:D(G)}),F={brandId:((h=e==null?void 0:e.brand)==null?void 0:h.id)||"",name:(e==null?void 0:e.name)||""},{isDirty:q}=U({control:p}),b=()=>!q;f.useEffect(()=>{e&&C(F)},[e]);const{findAllEquipmentBrands:m,updateEquipmentModel:v}=H(),w=async r=>{if(!b())return new Promise((t,i)=>{v.mutateAsync({brandId:e.brand.id,modelId:e.id,...r}).then(()=>{d(),A("Marca atualizada com sucesso!"),t()}).catch(c=>{if(c.error.code==="EQU-005"){L("name",{model:"manual",message:"Nome jÃ¡ existente"}),i();return}d(),P("Erro ao atualizar marca!"),i()})})};return a.jsx(k,{mode:"form",title:"Editar Modelo",open:s,onClose:d,submitButtonText:"Editar Modelo",onSubmit:T(w),disabled:m.isLoading||b(),children:a.jsxs(y,{sx:{padding:3,gap:2},children:[a.jsx(B,{isLoading:m.isLoading,LoadingComponent:a.jsx(N,{variant:"rounded",width:"100%",height:52}),LoadedComponent:a.jsx(S,{fullWidth:!0,children:a.jsx(W,{name:"brandId",control:p,defaultValue:"",render:({field:r})=>{var E,j;const t=m.data??[],i=["",...t.map(n=>n.name)],c=((E=t.find(n=>n.id===r.value))==null?void 0:E.name)||"";return a.jsx(V,{ref:r.ref,inputRef:u,label:"Marca",data:i,value:c,onChange:n=>{const l=t.find(R=>R.name===n);r.onChange((l==null?void 0:l.id)||"")},error:!!o.brandId,helperText:(j=o.brandId)==null?void 0:j.message})}})})}),a.jsx(S,{fullWidth:!0,children:a.jsx(z,{...M("name"),label:"Nome",error:!!o.name,helperText:(x=o.name)==null?void 0:x.message,autoComplete:"off",InputLabelProps:{shrink:((g=I("name"))==null?void 0:g.length)>0}})})]})})};export{Z as default};
