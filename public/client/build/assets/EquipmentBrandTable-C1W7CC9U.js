import{e as O,r as c,j as a,S as i,aN as I,h as t,aZ as f,a_ as b,a$ as h,aE as _,aF as j,ax as z,aH as L,aj as A,ay as F,b0 as W,f as $,B as k,aM as U,b1 as N,aC as P,b2 as R,ab as H,s as v}from"./index-C9HasOiM.js";import{u as Q}from"./useEquipment-ClzBGdbo.js";import{E as V}from"./List-DmlXCq5l.js";import{M as Z}from"./MoreVert-CDz2P5kD.js";import{E as G}from"./Edit-CYRFZ1bJ.js";import"./equipment-DQ8Bx2dX.js";import"./Container-B2tOqq2a.js";import"./Add-Hwv7pAxz.js";const ne=()=>{const{role:E}=O(),{findAllEquipmentBrands:g,deleteEquipmentBrand:y}=Q(),{data:B,isLoading:C}=g,[p,u]=c.useState({isOpen:!1,brand:null}),M=e=>{u({isOpen:!0,brand:e})},q=()=>{u({isOpen:!1,brand:null})},[m,x]=c.useState({isOpen:!1,brandId:null}),S=e=>{x({isOpen:!0,brandId:e})},l=()=>{x({isOpen:!1,brandId:null})},D=()=>new Promise((e,n)=>{m.brandId?y.mutateAsync({brandId:m.brandId}).then(()=>{H("Marca eliminada com sucesso!"),l(),e()}).catch(s=>{if(s.error.code==="EQU-010"){l(),v("Esta marca está associada a um ou mais equipamentos e não pode ser eliminada!",{duration:6e3}),n();return}l(),v("Erro ao eliminar marca"),n()}):(l(),n())}),T=c.useMemo(()=>[{id:"name",label:"Nome",align:"left",sortable:!0,renderComponent:({row:e})=>a.jsxs(i,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[e==null?void 0:e.name,(e==null?void 0:e.description)&&a.jsx(I,{fontSize:"small",title:e==null?void 0:e.description})]})},{id:"created_by_user",visible:!1},{id:"created_at_datetime",label:"Criado por",align:"left",sortable:!0,renderComponent:({row:e})=>{var n,s,d,o,r;return a.jsx(a.Fragment,{children:a.jsxs(i,{sx:{flexDirection:"row",gap:2},children:[a.jsx(i,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:e!=null&&e.created_by_user?a.jsxs(a.Fragment,{children:[a.jsx(f,{alt:(n=e==null?void 0:e.created_by_user)==null?void 0:n.username,src:`${b}/users/${(s=e==null?void 0:e.created_by_user)==null?void 0:s.id}/avatar?size=80`,name:(d=e==null?void 0:e.created_by_user)==null?void 0:d.username}),a.jsxs(i,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(t,{variant:"p",component:"p",fontWeight:500,children:(o=e==null?void 0:e.created_by_user)==null?void 0:o.username}),a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:(r=e==null?void 0:e.created_by_user)==null?void 0:r.role})]})]}):a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})}),a.jsx(h,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),a.jsxs(i,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(t,{variant:"p",component:"p",fontWeight:500,children:_(e==null?void 0:e.created_at_datetime)}),a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:j(e==null?void 0:e.created_at_datetime)})]})]})})}},{id:"last_modified_by_user",visible:!1},{id:"last_modified_datetime",label:"Modificado pela última vez por",align:"left",sortable:!0,renderComponent:({row:e})=>{var n,s,d,o,r;return a.jsx(a.Fragment,{children:e!=null&&e.last_modified_datetime?a.jsxs(i,{sx:{flexDirection:"row",gap:2},children:[a.jsx(i,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:e!=null&&e.last_modified_by_user?a.jsxs(a.Fragment,{children:[a.jsx(f,{alt:(n=e==null?void 0:e.last_modified_by_user)==null?void 0:n.username,src:`${b}/users/${(s=e==null?void 0:e.last_modified_by_user)==null?void 0:s.id}/avatar?size=80`,name:(d=e==null?void 0:e.last_modified_by_user)==null?void 0:d.username}),a.jsxs(i,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(t,{variant:"p",component:"p",fontWeight:500,children:(o=e==null?void 0:e.last_modified_by_user)==null?void 0:o.username}),a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:(r=e==null?void 0:e.last_modified_by_user)==null?void 0:r.role})]})]}):a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})}),a.jsx(h,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),a.jsxs(i,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[a.jsx(t,{variant:"p",component:"p",fontWeight:500,children:_(e==null?void 0:e.last_modified_datetime)}),a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:j(e==null?void 0:e.last_modified_datetime)})]})]}):a.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Ainda não foi modificado"})})}},{id:"more_options",align:"right",sortable:!1,renderComponent:({row:e})=>a.jsx(z,{mode:"custom",customButton:a.jsx(L,{title:"Mais opções",sx:{margin:-1},children:a.jsx(A,{children:a.jsx(Z,{})})}),children:a.jsx(F,{buttons:[{label:"Editar",icon:a.jsx(G,{fontSize:"small"}),onClick:()=>M(e)},...E!=="Funcionário"?[{label:"Eliminar",icon:a.jsx(W,{fontSize:"small",color:"error"}),color:"error",divider:!0,onClick:()=>S(e==null?void 0:e.id)}]:[]]})})}],[]);return a.jsx($,{elevation:1,children:a.jsxs(k,{sx:{marginTop:3},children:[a.jsx(U,{isLoading:C,LoadingComponent:a.jsx(N,{mode:"datatable"}),LoadedComponent:a.jsx(P,{mode:"datatable",data:B??[],columns:T})}),a.jsx(V,{brand:p.brand,open:p.isOpen,onClose:q}),a.jsx(R,{mode:"delete",title:"Eliminar Marca",open:m.isOpen,onClose:l,onSubmit:D,description:"Tem a certeza que deseja eliminar esta marca?",subDescription:"Ao eliminar esta marca, todos os dados relacionados, incluindo modelos, serão removidos de forma permanente."})]})})};export{ne as default};
