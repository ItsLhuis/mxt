import{d as F,r as w,bd as y,j as e,ay as T,S as A,G as o,az as j,an as f,f as L,g as b,B as k,L as v,t as B,s as P,aB as I}from"./index-DI1axIxw.js";import{b as R}from"./user-CZVbcN9v.js";const N=({user:a,isLoading:S,isError:z})=>{var u,h,x,p;const s=!S&&!z,{register:d,handleSubmit:C,formState:{errors:t},setError:l,reset:E,watch:i}=F({resolver:B(R),defaultValues:{username:"",email:""}}),r={username:(a==null?void 0:a.username)||"",email:(a==null?void 0:a.email)||""},m=()=>{const n=i();return n.username===r.username&&n.email===r.email};w.useEffect(()=>{s&&a&&E(r)},[s,a]);const{updateUserProfile:c}=y(),U=async n=>{!s||m()||await c.mutateAsync(n).then(()=>P("Conta atualizada com sucesso!")).catch(g=>{g.error.code==="USR-001"?l("username",{type:"manual",message:"Nome de utilizador já existente"}):g.error.code==="USR-002"?l("email",{type:"manual",message:"E-mail já existente"}):I("Erro ao atualizar conta!")})};return e.jsxs(e.Fragment,{children:[e.jsx(T,{title:"Conta",description:"Atualizar dados da conta do utilizador"}),e.jsx("form",{onSubmit:C(U),children:e.jsxs(A,{sx:{paddingTop:1},children:[e.jsxs(o,{container:!0,spacing:2,sx:{paddingInline:3},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(j,{isLoading:!s,LoadingComponent:e.jsx(f,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(L,{fullWidth:!0,children:e.jsx(b,{...d("username"),label:"Nome de utilizador",error:!!t.username,helperText:(u=t.username)==null?void 0:u.message,InputLabelProps:{shrink:((h=i("username"))==null?void 0:h.length)>0}})})})}),e.jsx(o,{item:!0,xs:12,children:e.jsx(j,{isLoading:!s,LoadingComponent:e.jsx(f,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(L,{fullWidth:!0,children:e.jsx(b,{...d("email"),label:"E-mail",error:!!t.email,helperText:(x=t.email)==null?void 0:x.message,InputLabelProps:{shrink:((p=i("email"))==null?void 0:p.length)>0}})})})})]}),e.jsx(k,{sx:{marginLeft:"auto",padding:3},children:e.jsx(v,{loading:c.isPending,type:"submit",variant:"contained",sx:{marginLeft:"auto"},disabled:!s||m(),children:"Atualizar Conta"})})]})})]})};export{N as default};
