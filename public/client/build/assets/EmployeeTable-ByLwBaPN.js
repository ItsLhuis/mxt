import{u as C,S as y,b as S,r as t,j as o,Z as c,au as E,av as M,Y as a,ag as u,ab as _,ah as A,ai as D,ac as I,aw as L,a as T,B,ax as z,ay as O,ae as k,az as P}from"./index-BCLPk4lW.js";import{f as N}from"./phone-DqZOodLQ.js";import{M as U}from"./MoreVert-ComDCJYh.js";import{E as $}from"./Edit-w3TYi8cQ.js";const W=()=>{const p=C(),{id:s,role:x}=y(),{findAllEmployees:b,deleteEmployee:v}=S(),{data:l,isLoading:f}=b,[r,i]=t.useState({isOpen:!1,userId:null}),h=e=>{i({isOpen:!0,userId:e})},n=()=>{i({isOpen:!1,userId:null})},j=()=>new Promise((e,m)=>{r.userId?v.mutateAsync({userId:r.userId}).then(()=>{n(),e()}).catch(()=>{n(),m()}):(n(),m())}),d=t.useMemo(()=>l?l.filter(e=>e.user.id!==s):[],[l,s]);console.log(d);const g=t.useMemo(()=>[{id:"user.username",label:"Utilizador",align:"left",sortable:!0,renderComponent:({row:e})=>o.jsxs(c,{sx:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",gap:1},children:[o.jsx(E,{alt:e.user.username,src:`${M}/users/${e.user.id}/avatar?size=80`,name:e.user.username}),o.jsxs(c,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[o.jsx(a,{variant:"p",component:"p",fontWeight:500,children:e.user.username}),o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:e.user.role})]})]})},{id:"user.is_active",label:"Estado",align:"left",sortable:!0,renderComponent:({row:e})=>o.jsx(o.Fragment,{children:e.user.is_active?o.jsx(u,{color:"success",label:"Ativo"}):o.jsx(u,{color:"error",label:"Inativo"})})},{id:"name",label:"Nome",align:"left",sortable:!0,renderComponent:({row:e})=>e.name?e.name:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"user.email",label:"E-mail",align:"left",sortable:!0,renderComponent:({row:e})=>e.user.email?e.user.email:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"phone_number",label:"Contacto",align:"left",sortable:!0,renderComponent:({row:e})=>e.phone_number?N(e.phone_number):o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"country",label:"País",align:"left",sortable:!0,renderComponent:({row:e})=>e.country?e.country:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"city",label:"Cidade",align:"left",sortable:!0,renderComponent:({row:e})=>e.city?e.city:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"locality",label:"Localidade",align:"left",sortable:!0,renderComponent:({row:e})=>e.locality?e.locality:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"address",label:"Morada",align:"left",sortable:!0,renderComponent:({row:e})=>e.address?e.address:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"postal_code",label:"Código postal",align:"left",sortable:!0,renderComponent:({row:e})=>e.postal_code?e.postal_code:o.jsx(a,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"more_options",align:"right",sortable:!1,renderComponent:({row:e})=>e.user.role!=="Chefe"&&!(x==="Administrador"&&e.user.role==="Administrador")?o.jsx(_,{mode:"custom",customButton:o.jsx(A,{title:"Mais opções",sx:{margin:-1},children:o.jsx(D,{children:o.jsx(U,{})})}),children:o.jsx(I,{buttons:[{label:"Editar",icon:o.jsx($,{fontSize:"small"}),onClick:()=>p(`/employee/${e.user.id}`)},{label:"Eliminar",icon:o.jsx(L,{fontSize:"small",color:"error"}),color:"error",divider:!0,onClick:()=>h(e.user.id)}]})}):null}],[]);return o.jsx(T,{elevation:1,children:o.jsxs(B,{sx:{marginTop:3},children:[o.jsx(z,{isLoading:f,LoadingComponent:o.jsx(O,{mode:"datatable"}),LoadedComponent:o.jsx(k,{mode:"datatable",data:d??[],columns:g})}),o.jsx(P,{mode:"delete",title:"Eliminar Funcionário",open:r.isOpen,onClose:n,onSubmit:j,description:"Tem a certeza que deseja eliminar este funcionário?",subDescription:"Ao eliminar este funcionário, os dados serão removidos de forma permanente."})]})})};export{W as default};
