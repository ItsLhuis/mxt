import{r as l,o as E,j as e,f as F,H as x,B as S,b9 as R,aT as v,S as A,F as u,T as c,aj as B,s as g}from"./index-D-gKbxy2.js";import{u as U,t as z}from"./index-DampQ2Jc.js";import{u as M}from"./user-_ZvJi3ui.js";import{a as W}from"./Settings-DiPLNfBD.js";import"./isPossiblePhoneNumber-DES16dOz.js";import"./Container-CiMvQ9y6.js";import"./Tabs-Z7mQeWih.js";const q=()=>{var m,h,f;const{register:t,handleSubmit:j,formState:{errors:s},setError:P}=U({resolver:z(M)}),[o,r]=l.useState(!1),n=l.useRef(null);l.useEffect(()=>{const i=setTimeout(()=>{o&&n.current&&n.current.focus()},100);return()=>clearTimeout(i)},[o]);const{findUserProfile:a,updateUserPassword:T}=E(),p=!a.isLoading&&!a.isError,b=async i=>new Promise((y,d)=>{var w;p?T.mutateAsync({userId:(w=a==null?void 0:a.data)==null?void 0:w.id,...i}).then(()=>{r(!1),B("Senha atualizada com sucesso!"),y()}).catch(C=>{if(C.error.code==="USR-005"){P("password",{type:"manual",message:"Senha atual incorreta"}),d();return}r(!1),g("Erro ao atualizar senha!"),d()}):(r(!1),g("Erro ao atualizar senha!"),d())});return e.jsxs(e.Fragment,{children:[e.jsxs(F,{elevation:1,children:[e.jsx(x,{title:"Segurança",description:"Definições de Segurança",icon:e.jsx(W,{})}),e.jsxs(S,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",gap:2,paddingBottom:2,paddingRight:3},children:[e.jsx(x,{title:"Senha",description:"Altere a sua senha"}),e.jsx(S,{sx:{paddingTop:2},children:e.jsx(R,{variant:"contained",color:"error",disabled:!p,onClick:()=>r(!0),children:"Alterar Senha"})})]})]}),e.jsx(v,{open:o,onClose:()=>r(!1),mode:"form",title:"Alterar Senha",submitButtonText:"Alterar Senha",color:"error",onSubmit:j(b),children:e.jsxs(A,{sx:{padding:3,gap:2},children:[e.jsx(u,{fullWidth:!0,children:e.jsx(c,{inputRef:n,...t("password"),type:"password",label:"Senha atual",error:!!s.password,helperText:(m=s.password)==null?void 0:m.message,autoComplete:"current-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...t("newPassword"),type:"password",label:"Nova senha",error:!!s.newPassword,helperText:(h=s.newPassword)==null?void 0:h.message,autoComplete:"new-password"})}),e.jsx(u,{fullWidth:!0,children:e.jsx(c,{...t("confirmPassword"),type:"password",label:"Confirmar nova senha",error:!!s.confirmPassword,helperText:(f=s.confirmPassword)==null?void 0:f.message,autoComplete:"new-password"})})]})})]})};export{q as default};
