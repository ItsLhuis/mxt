import{r as v,j as i,S as n,aF as I,aG as A,h as t,aI as E,aJ as L,aK as R,B as j,b1 as H,b0 as S,b2 as q,b5 as z,b6 as W,b7 as k,aT as g,f as B,H as $,aR as K,aS as N}from"./index-_NktdslD.js";import{C as O}from"./Check-DhRqV4Lx.js";import{H as P}from"./History-B4BUT27R.js";const J=({equipment:T,isLoading:r,isError:F})=>{var C;const _=!r&&!F,M=v.useMemo(()=>[{id:"type",label:"Atividade",align:"left",sortable:!0},{id:"responsible_user",label:"Responsável",align:"left",sortable:!1,renderComponent:({row:a})=>{var h,s,l,d,f;return i.jsx(i.Fragment,{children:a!=null&&a.responsible_user?i.jsxs(n,{sx:{flexDirection:"row",gap:2},children:[i.jsxs(n,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[i.jsx(I,{alt:(h=a==null?void 0:a.responsible_user)==null?void 0:h.username,src:`${A}/users/${(s=a==null?void 0:a.responsible_user)==null?void 0:s.id}/avatar?size=80`,name:(l=a==null?void 0:a.responsible_user)==null?void 0:l.username}),i.jsxs(n,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[i.jsx(t,{variant:"p",component:"p",fontWeight:500,children:(d=a==null?void 0:a.responsible_user)==null?void 0:d.username}),i.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:(f=a==null?void 0:a.responsible_user)==null?void 0:f.role})]})]}),i.jsx(E,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),i.jsxs(n,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[i.jsx(t,{variant:"p",component:"p",fontWeight:500,children:L(a==null?void 0:a.created_at_datetime)}),i.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:R(a==null?void 0:a.created_at_datetime)})]})]}):i.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})})}}],[]),D=v.useMemo(()=>({row:a})=>{var l,d,f,y;const h=v.useMemo(()=>[{id:"field",label:"Campo",align:"left",sortable:!0},{id:"before",label:"Antes",align:"left",sortable:!0,renderComponent:({row:e})=>{var c,p,m,x,b,u;return(e==null?void 0:e.field)==="Descrição"&&e!=null&&e.before?i.jsx(j,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:i.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:H(e==null?void 0:e.before)})}):(e==null?void 0:e.field)==="Cliente"&&e!=null&&e.before?i.jsxs(n,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[(c=e==null?void 0:e.before)==null?void 0:c.name,((p=e==null?void 0:e.before)==null?void 0:p.description)&&i.jsx(S,{title:(m=e==null?void 0:e.before)==null?void 0:m.description})]}):(e==null?void 0:e.field)==="Tipo"&&e!=null&&e.before?i.jsx(i.Fragment,{children:(x=e==null?void 0:e.before)==null?void 0:x.name}):(e==null?void 0:e.field)==="Marca"&&e!=null&&e.before?i.jsx(i.Fragment,{children:(b=e==null?void 0:e.before)==null?void 0:b.name}):(e==null?void 0:e.field)==="Modelo"&&e!=null&&e.before?i.jsx(i.Fragment,{children:(u=e==null?void 0:e.before)==null?void 0:u.name}):e!=null&&e.before?e==null?void 0:e.before:i.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})}},{id:"after",label:"Depois",align:"left",sortable:!0,renderComponent:({row:e})=>{var c,p,m,x,b,u;return(e==null?void 0:e.field)==="Descrição"&&e!=null&&e.after?i.jsx(j,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:i.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:H(e==null?void 0:e.after)})}):(e==null?void 0:e.field)==="Cliente"&&e!=null&&e.after?i.jsxs(n,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[(c=e==null?void 0:e.after)==null?void 0:c.name,((p=e==null?void 0:e.after)==null?void 0:p.description)&&i.jsx(S,{title:(m=e==null?void 0:e.after)==null?void 0:m.description})]}):(e==null?void 0:e.field)==="Tipo"&&e!=null&&e.after?i.jsx(i.Fragment,{children:(x=e==null?void 0:e.after)==null?void 0:x.name}):(e==null?void 0:e.field)==="Marca"&&e!=null&&e.after?i.jsx(i.Fragment,{children:(b=e==null?void 0:e.after)==null?void 0:b.name}):(e==null?void 0:e.field)==="Modelo"&&e!=null&&e.after?i.jsx(i.Fragment,{children:(u=e==null?void 0:e.after)==null?void 0:u.name}):e!=null&&e.after?e==null?void 0:e.after:i.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})}},{id:"changed",label:"Alterado",align:"left",sortable:!0,renderComponent:({row:e})=>i.jsx(i.Fragment,{children:e!=null&&e.changed?i.jsx(O,{color:"success"}):i.jsx(q,{color:"error"})})}],[]),s=v.useMemo(()=>[{id:"file_mime_type",label:"Tipo",align:"left",sortable:!0,renderComponent:({row:e})=>i.jsx(n,{sx:{alignItems:"flex-start"},children:(e==null?void 0:e.file_mime_type)==="application/pdf"?i.jsx("img",{src:z}):e!=null&&e.file_mime_type.startsWith("image/")?i.jsx("img",{src:W}):i.jsx("img",{src:k})})},{id:"original_filename",label:"Ficheiro",align:"left",sortable:!0,renderComponent:({row:e})=>i.jsxs(n,{children:[i.jsx(t,{variant:"p",component:"p",children:e==null?void 0:e.original_filename}),i.jsx(t,{variant:"p",component:"p",sx:{color:"var(--outline)"},children:`${(e==null?void 0:e.file_size)<1024*1024?((e==null?void 0:e.file_size)/1024).toFixed(2)+" Kb":((e==null?void 0:e.file_size)/(1024*1024)).toFixed(2)+" Mb"}`})]})}],[]);return i.jsx(j,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden",margin:3},children:((l=a==null?void 0:a.details[0])==null?void 0:l.field)==="Anexos"?i.jsx(i.Fragment,{children:(d=a==null?void 0:a.details[0])!=null&&d.after?i.jsx(g,{data:((f=a==null?void 0:a.details[0])==null?void 0:f.after)??[],columns:s}):i.jsx(g,{showSearch:!1,data:[(y=a==null?void 0:a.details[0])==null?void 0:y.before],columns:s})}):i.jsx(g,{data:(a==null?void 0:a.details)??[],columns:h})})},[]);return i.jsxs(B,{elevation:1,children:[i.jsx($,{title:"Histórico de Atividades",description:"Histórico de atividades sobre o equipamento",icon:i.jsx(P,{})}),i.jsx(K,{isLoading:!_,LoadingComponent:i.jsx(N,{mode:"datatable"}),LoadedComponent:i.jsx(j,{sx:{margin:3,border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:i.jsx(g,{mode:"datatable",data:_?(C=T[0])==null?void 0:C.interactions_history:[],columns:M,ExpandableContentComponent:D})})})]})};export{J as default};
