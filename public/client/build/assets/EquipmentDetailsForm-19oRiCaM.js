import{r as ea,j as a,f as ta,H as ia,ay as la,S as u,aR as j,a$ as m,h as Q,a7 as ca,b0 as ha,F as f,aW as C,T as xa,b3 as ga,B as ja,L as ma,ak as fa,s as pa}from"./index-_NktdslD.js";import{u as ua,b as Ca,a as La,C as p,t as ba}from"./index-8QsUXVhp.js";import{u as Ia}from"./equipment-DMqeKo_-.js";import{u as ya}from"./useEquipment-Dy7ZmQ0L.js";const Sa=({equipment:o,isLoading:G,isError:J})=>{var E,v,B,T,S,w,F,W,M,k,A,D,N,V,z,P,R,H,U,$;const e=!G&&!J,{control:c,register:K,handleSubmit:O,setValue:X,getValues:Y,formState:{errors:t},setError:Z,reset:_}=ua({resolver:ba(Ia)}),q={typeId:((v=(E=o==null?void 0:o[0])==null?void 0:E.type)==null?void 0:v.id)||"",brandId:((T=(B=o==null?void 0:o[0])==null?void 0:B.brand)==null?void 0:T.id)||"",modelId:((w=(S=o==null?void 0:o[0])==null?void 0:S.model)==null?void 0:w.id)||"",sn:((F=o==null?void 0:o[0])==null?void 0:F.sn)||"",description:((W=o==null?void 0:o[0])==null?void 0:W.description)||""},{isDirty:aa}=Ca({control:c}),L=()=>!aa;ea.useEffect(()=>{e&&o&&o[0]&&_(q)},[e,o]);const{findAllEquipmentTypes:b,findAllEquipmentBrands:I,findAllEquipmentModelsByBrandId:oa,updateEquipment:y}=ya(),{data:sa,isLoading:na,isError:ra}=oa(La({control:c,name:"brandId",defaultValue:(k=(M=o==null?void 0:o[0])==null?void 0:M.brand)==null?void 0:k.id})),da=async s=>{!e||L()||await y.mutateAsync({equipmentId:o[0].id,...s,description:s.description===""?null:s.description}).then(()=>fa("Equipamento atualizado com sucesso!")).catch(r=>{if(r.error.code==="EQU-008"){Z("sn",{type:"manual",message:"Número de série já existente"});return}pa("Erro ao atualizar equipamento!")})};return a.jsxs(ta,{elevation:1,children:[a.jsx(ia,{title:"Detalhes",description:"Cliente, tipo, marca, modelo,... do equipamento",icon:a.jsx(la,{})}),a.jsx("form",{onSubmit:O(da),children:a.jsxs(u,{sx:{padding:3,paddingTop:2,gap:2},children:[a.jsx(j,{isLoading:!e,LoadingComponent:a.jsx(m,{variant:"rounded",width:"100%",height:52}),LoadedComponent:a.jsxs(u,{children:[a.jsx(Q,{variant:"p",component:"p",sx:{color:"var(--outline)",fontWeight:550},children:"Cliente"}),a.jsxs(u,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[a.jsx(Q,{variant:"p",component:"p",children:a.jsx(ca,{to:`/client/${(D=(A=o==null?void 0:o[0])==null?void 0:A.client)==null?void 0:D.id}`,children:(V=(N=o==null?void 0:o[0])==null?void 0:N.client)==null?void 0:V.name})}),((P=(z=o==null?void 0:o[0])==null?void 0:z.client)==null?void 0:P.description)&&a.jsx(ha,{title:(H=(R=o==null?void 0:o[0])==null?void 0:R.client)==null?void 0:H.description})]})]})}),a.jsx(j,{isLoading:!e||b.isLoading,LoadingComponent:a.jsx(m,{variant:"rounded",width:"100%",height:52}),LoadedComponent:a.jsx(f,{fullWidth:!0,children:a.jsx(p,{name:"typeId",control:c,render:({field:s})=>{var i,l;const r=b.data??[],h=["",...r.map(n=>n.name)],x=((i=r.find(n=>n.id===s.value))==null?void 0:i.name)||"";return a.jsx(C,{ref:s.ref,label:"Tipo",data:h,value:x,onChange:n=>{const d=r.find(g=>g.name===n);s.onChange((d==null?void 0:d.id)||"")},error:!!t.typeId,helperText:(l=t.typeId)==null?void 0:l.message})}})})}),a.jsx(j,{isLoading:!e||I.isLoading,LoadingComponent:a.jsx(m,{variant:"rounded",width:"100%",height:52}),LoadedComponent:a.jsx(f,{fullWidth:!0,children:a.jsx(p,{name:"brandId",control:c,render:({field:s})=>{var i,l;const r=I.data??[],h=["",...r.map(n=>n.name)],x=((i=r.find(n=>n.id===s.value))==null?void 0:i.name)||"";return a.jsx(C,{ref:s.ref,label:"Marca",data:h,value:x,onChange:n=>{const d=r.find(g=>g.name===n);s.onChange((d==null?void 0:d.id)||""),X("modelId","")},error:!!t.brandId,helperText:(l=t.brandId)==null?void 0:l.message})}})})}),a.jsx(j,{isLoading:!e||na&&ra,LoadingComponent:a.jsx(m,{variant:"rounded",width:"100%",height:52}),LoadedComponent:a.jsx(f,{fullWidth:!0,children:a.jsx(p,{name:"modelId",control:c,render:({field:s})=>{var i,l;const r=sa??[],h=["",...r.map(n=>n.name)],x=((i=r.find(n=>n.id===s.value))==null?void 0:i.name)||"";return a.jsx(C,{ref:s.ref,label:"Modelo",data:h,value:x,onChange:n=>{const d=r.find(g=>g.name===n);s.onChange((d==null?void 0:d.id)||"")},error:!!t.modelId,helperText:(l=t.modelId)==null?void 0:l.message})}})})}),a.jsx(j,{isLoading:!e,LoadingComponent:a.jsx(m,{variant:"rounded",width:"100%",height:52}),LoadedComponent:a.jsx(f,{fullWidth:!0,children:a.jsx(xa,{...K("sn"),label:"Número de série",error:!!t.sn,helperText:(U=t.sn)==null?void 0:U.message,autoComplete:"off",InputLabelProps:{shrink:(($=Y("sn"))==null?void 0:$.length)>0}})})}),a.jsx(p,{name:"description",control:c,render:({field:s})=>a.jsx(ga,{label:"Descrição",value:s.value,onChange:s.onChange,isLoading:!e})}),a.jsx(ja,{sx:{marginLeft:"auto",marginTop:1},children:a.jsx(ma,{loading:y.isPending,type:"submit",variant:"contained",disabled:!e||L(),children:"Atualizar Equipamento"})})]})})]})};export{Sa as default};
