import{r as m,j as r,aT as E,S as j,bA as T,F as R,T as b,aj as g,s as C}from"./index-mWc9gLhA.js";import{u as A,C as w,t as F}from"./index-COzNbWAj.js";import{a as y}from"./repair-D-n4dckQ.js";import{u as N}from"./useRepair-BcwC0uik.js";const B=({open:t,onClose:a})=>{var u;const{control:c,register:l,handleSubmit:d,formState:{errors:n},setError:f,reset:s}=A({resolver:F(y)}),o=m.useRef(null);m.useEffect(()=>{if(!t){s();return}const e=setTimeout(()=>{t&&o.current&&o.current.focus()},100);return()=>clearTimeout(e)},[t]);const{createNewRepairStatus:p}=N(),x=async e=>new Promise((h,i)=>{p.mutateAsync(e).then(()=>{a(),g("Estado adicionado com sucesso!"),s(),h()}).catch(S=>{if(S.error.code==="REP-007"){f("name",{type:"manual",message:"Nome jÃ¡ existente"}),i();return}a(),C("Erro ao adicionar estado!"),s(),i()})});return r.jsx(E,{mode:"form",title:"Adicionar Estado",open:t,onClose:a,submitButtonText:"Adicionar Estado",onSubmit:d(x),children:r.jsxs(j,{sx:{padding:3,gap:2},children:[r.jsx(w,{name:"color",control:c,defaultValue:"default",render:({field:e})=>r.jsx(T,{label:"Cor",selected:e.value,onChange:e.onChange})}),r.jsx(R,{fullWidth:!0,children:r.jsx(b,{...l("name"),label:"Nome",error:!!n.name,helperText:(u=n.name)==null?void 0:u.message,autoComplete:"off",inputRef:o})})]})})};export{B as default};
