import{q as Ze,j as e,r as w,bG as le,aG as se,aQ as H,b1 as B,b as es,f as ss,H as ns,az as ts,bH as is,S as $,B as O,aR as b,a$ as D,aH as ls,G as Qe,h as G,a7 as Je,b0 as os,F as z,aW as as,aL as ds,aM as rs,ah as cs,aN as xs,aO as ms,bI as ee,b3 as V,L as hs,bJ as ps,bD as us,ak as js,s as gs}from"./index-_NktdslD.js";import{u as ys,b as fs,a as vs,C as p,t as bs}from"./index-8QsUXVhp.js";import{u as Ds}from"./repair-j_MUsWAD.js";import{u as Cs}from"./useRepair-MRRzMLfz.js";import{u as Ls}from"./useCompany-d5GTC3bD.js";import{D as ie}from"./DatePicker-BGOzZpif.js";import{f as ne}from"./phone-B8ybmA3k.js";import{g as Is}from"./getValidChipColor-D8WVyITM.js";import{T as Ss,a as Ye}from"./Tabs-B8rkhaSb.js";import{S as ws}from"./Switch-7Nyh-1Sw.js";import"./isPossiblePhoneNumber-DES16dOz.js";const Ns=Ze(e.jsx("path",{d:"M18 16h-2v-1H8v1H6v-1H2v5h20v-5h-4zm2-8h-3V6c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v2H4c-1.1 0-2 .9-2 2v4h4v-2h2v2h8v-2h2v2h4v-4c0-1.1-.9-2-2-2m-5 0H9V6h6z"}),"HomeRepairService"),Rs=Ze(e.jsx("path",{d:"m21.41 11.58-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42M5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7"}),"LocalOffer"),$s=(s,{margin:g=0}={})=>new Promise((u,t)=>{const l=document.createElement("iframe");document.body.appendChild(l);const i=l.contentDocument||l.contentWindow.document,h=`
        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="utf-8" />
            <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
            <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap" rel="stylesheet" />
            <style type="text/css" media="print">
                * {
                    margin: 0;
                    -webkit-print-color-adjust: exact;
                }

                @page {
                    margin: ${g};
                }

                body {
                    position: relative;
                    min-height: 100vh;
                    font-family: 'Poppins', Arial, sans-serif;
                    font-size: 13px;
                }

                hr {
                    display: block;
                    height: 1px;
                    border: 0;
                    border-top: 1px solid #ccc;
                    padding: 0;
                }
            </style>
        </head>
        <body>
            ${s}
        </body>
        </html>
    `;i.open(),i.write(h),i.close(),l.onload=()=>{try{l.contentWindow.focus(),l.contentWindow.print(),setTimeout(()=>{document.body.removeChild(l),u()},500)}catch(o){document.body.removeChild(l),t(o)}},l.onerror=o=>{document.body.removeChild(l),t(o)}}),As=w.forwardRef(({repairData:s,companyData:g,isFinished:u},t)=>{var T,I,E;if(!u)return;const{id:l,equipment:i,entry_datetime:h,entry_accessories:o,entry_accessories_description:j,conclusion_datetime:N,delivery_datetime:f}=s,{name:A,email:C,website:L,address:a,postal_code:W,locality:R,city:v,country:d,phone_number:k}=g;return e.jsx(le,{ref:t,header:e.jsxs("header",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("h1",{children:"Entrega do Equipamento"}),e.jsx("h4",{children:`#${l}`})]}),e.jsxs("div",{style:{fontWeight:"normal"},children:[e.jsx("h4",{children:A}),e.jsx("p",{children:`${a}, ${W}, ${R}`}),e.jsx("p",{children:`${v}, ${d}`})]})]}),e.jsx("img",{src:`${se}/company/logo?size=1400`,style:{maxHeight:160,maxWidth:160}})]}),e.jsx("hr",{style:{marginTop:"8px"}})]}),body:e.jsxs("main",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"16px"},children:[e.jsx("style",{children:`
              .label-main {
                font-weight: 550;
              }
              .label-signature {
                font-size: 10px;
              }
            `}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Equipamento"}),e.jsx("p",{children:`${(T=i==null?void 0:i.type)==null?void 0:T.name}, ${(I=i==null?void 0:i.brand)==null?void 0:I.name} ${(E=i==null?void 0:i.model)==null?void 0:E.name} #${i==null?void 0:i.sn}`})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de entrada"}),e.jsx("p",{children:H(h)||"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Acessórios"}),e.jsx("p",{children:o.length>0?o.map(_=>_==null?void 0:_.name).join(", "):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:j&&"4px",width:"100%"},children:[e.jsx("label",{className:"label-main",children:"Descrição dos acessórios"}),e.jsx("div",{style:j&&{border:"1px solid #ccc",padding:"16px",borderRadius:"8px"},children:j?e.jsx("span",{dangerouslySetInnerHTML:B(j)}):e.jsx("p",{children:"Sem valor"})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de conclusão"}),e.jsx("p",{children:N?H(N):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de entrega"}),e.jsx("p",{children:f?H(f):"Sem valor"})]}),e.jsx("div",{style:{width:"100%",padding:"32px 0",pageBreakInside:"avoid"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx("p",{className:"label-signature",children:"Declaro que recebi o equipamento e todos os acessórios"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",width:"50%",padding:"32px",paddingBottom:"0px"},children:[e.jsx("hr",{style:{width:"100%",marginBottom:"8px"}}),e.jsx("p",{className:"label-signature label-main",children:"Assinatura"})]})]})})]}),footer:e.jsxs("footer",{children:[e.jsx("style",{children:`
            .p-footer {
              font-size: 10px;
            }
          `}),e.jsx("hr",{style:{marginBottom:"8px"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"p-footer",style:{fontWeight:"bold"},children:"Para mais informações, entre em contacto conosco"}),e.jsx("p",{className:"p-footer",children:`${ne(k)} | ${C}`})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{className:"p-footer",style:{fontWeight:"bold"},children:"Visite-nos"}),e.jsx("p",{className:"p-footer",children:L})]})]})]})})}),ks=w.forwardRef(({repairData:s,companyData:g,isFinished:u},t)=>{var S,X,Z,q,M,F;const l=es();if(!u)return;const{id:i,status:h,equipment:o,entry_datetime:j,entry_accessories:N,entry_accessories_description:f,entry_reported_issues:A,entry_reported_issues_description:C,intervention_works_done:L,intervention_works_done_description:a,intervention_accessories_used:W,intervention_accessories_used_description:R,conclusion_datetime:v,delivery_datetime:d,is_client_notified:k}=s,{name:T,email:I,website:E,address:_,postal_code:Q,locality:J,city:Y,country:K,phone_number:P}=g;return e.jsx(le,{ref:t,header:e.jsxs("header",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("h1",{children:"Ficha de Reparação"}),e.jsx("h4",{children:`#${i}`})]}),e.jsxs("div",{style:{fontWeight:"normal"},children:[e.jsx("h4",{children:T}),e.jsx("p",{children:`${_}, ${Q}, ${J}`}),e.jsx("p",{children:`${Y}, ${K}`})]})]}),e.jsx("img",{src:`${se}/company/logo?size=1400`,style:{maxHeight:160,maxWidth:160}})]}),e.jsx("hr",{style:{marginTop:"8px"}})]}),body:e.jsxs("main",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"16px"},children:[e.jsx("style",{children:`
              .label-main {
                font-weight: 550;
              }
            `}),e.jsx("span",{className:"status-span",style:{backgroundColor:((S=l.palette[h==null?void 0:h.color])==null?void 0:S.main)||"rgb(70, 70, 79)",color:((X=l.palette[h==null?void 0:h.color])==null?void 0:X.contrastText)||"rgb(228, 225, 230)",borderRadius:"8px",height:"32px",fontWeight:l.typography.fontWeightBold,display:"inline-flex",justifyContent:"center",alignItems:"center",padding:"0 12px",userSelect:"none",marginTop:"8px"},children:e.jsx("p",{style:{fontSize:"0.7125rem"},children:h==null?void 0:h.name})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Cliente"}),e.jsx("p",{children:(Z=o==null?void 0:o.client)==null?void 0:Z.name})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Equipamento"}),e.jsx("p",{children:`${(q=o==null?void 0:o.type)==null?void 0:q.name}, ${(M=o==null?void 0:o.brand)==null?void 0:M.name} ${(F=o==null?void 0:o.model)==null?void 0:F.name} #${o==null?void 0:o.sn}`})]}),e.jsx("div",{style:{width:"100%",borderBottom:"1px solid #ccc",marginTop:"8px"},children:e.jsx("h2",{children:"Entrada"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de entrada"}),e.jsx("p",{children:H(j)||"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Acessórios"}),e.jsx("p",{children:N.length>0?N.map(x=>x==null?void 0:x.name).join(", "):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:f&&"4px",width:"100%"},children:[e.jsx("label",{className:"label-main",children:"Descrição dos acessórios"}),e.jsx("div",{style:f&&{border:"1px solid #ccc",padding:"16px",borderRadius:"8px"},children:f?e.jsx("span",{dangerouslySetInnerHTML:B(f)}):e.jsx("p",{children:"Sem valor"})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Problemas reportados"}),e.jsx("p",{children:A.length>0?A.map(x=>x==null?void 0:x.name).join(", "):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:C&&"4px",width:"100%"},children:[e.jsx("label",{className:"label-main",children:"Descrição dos problemas reportados"}),e.jsx("div",{style:C&&{border:"1px solid #ccc",padding:"16px",borderRadius:"8px"},children:C?e.jsx("span",{dangerouslySetInnerHTML:B(C)}):e.jsx("p",{children:"Sem valor"})})]}),e.jsx("div",{style:{width:"100%",borderBottom:"1px solid #ccc",marginTop:"8px"},children:e.jsx("h2",{children:"Intervenção"})}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Trabalhos realizados"}),e.jsx("p",{children:L.length>0?L.map(x=>x==null?void 0:x.name).join(", "):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:a&&"4px",width:"100%"},children:[e.jsx("label",{className:"label-main",children:"Descrição dos trabalhos realizados"}),e.jsx("div",{style:a&&{border:"1px solid #ccc",padding:"16px",borderRadius:"8px"},children:a?e.jsx("span",{dangerouslySetInnerHTML:B(a)}):e.jsx("p",{children:"Sem valor"})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Acessórios usados"}),e.jsx("p",{children:W.length>0?W.map(x=>x==null?void 0:x.name).join(", "):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:R&&"4px",width:"100%"},children:[e.jsx("label",{className:"label-main",children:"Descrição dos acessórios usados"}),e.jsx("div",{style:R&&{border:"1px solid #ccc",padding:"16px",borderRadius:"8px"},children:R?e.jsx("span",{dangerouslySetInnerHTML:B(R)}):e.jsx("p",{children:"Sem valor"})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de conclusão"}),e.jsx("p",{children:v?H(v):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de entrega"}),e.jsx("p",{children:d?H(d):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Cliente notificado"}),e.jsx("p",{children:k?"Sim":"Não"})]})]}),footer:e.jsxs("footer",{children:[e.jsx("style",{children:`
            .p-footer {
              font-size: 10px;
            }
          `}),e.jsx("hr",{style:{marginBottom:"8px"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"p-footer",style:{fontWeight:"bold"},children:"Para mais informações, entre em contacto conosco"}),e.jsx("p",{className:"p-footer",children:`${ne(P)} | ${I}`})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{className:"p-footer",style:{fontWeight:"bold"},children:"Visite-nos"}),e.jsx("p",{className:"p-footer",children:E})]})]})]})})}),Ts=w.forwardRef(({repairData:s,companyData:g,isFinished:u},t)=>{var d,k,T;if(!u)return;const{id:l,equipment:i,entry_datetime:h,entry_accessories:o,entry_accessories_description:j}=s,{name:N,email:f,website:A,address:C,postal_code:L,locality:a,city:W,country:R,phone_number:v}=g;return e.jsx(le,{ref:t,header:e.jsxs("header",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("h1",{children:"Entrada do Equipamento"}),e.jsx("h4",{children:`#${l}`})]}),e.jsxs("div",{style:{fontWeight:"normal"},children:[e.jsx("h4",{children:N}),e.jsx("p",{children:`${C}, ${L}, ${a}`}),e.jsx("p",{children:`${W}, ${R}`})]})]}),e.jsx("img",{src:`${se}/company/logo?size=1400`,style:{maxHeight:160,maxWidth:160}})]}),e.jsx("hr",{style:{marginTop:"8px"}})]}),body:e.jsxs("main",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"16px"},children:[e.jsx("style",{children:`
              .label-main {
                font-weight: 550;
              }
            `}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Equipamento"}),e.jsx("p",{children:`${(d=i==null?void 0:i.type)==null?void 0:d.name}, ${(k=i==null?void 0:i.brand)==null?void 0:k.name} ${(T=i==null?void 0:i.model)==null?void 0:T.name} #${i==null?void 0:i.sn}`})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Data de entrada"}),e.jsx("p",{children:H(h)||"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("label",{className:"label-main",children:"Acessórios"}),e.jsx("p",{children:o.length>0?o.map(I=>I==null?void 0:I.name).join(", "):"Sem valor"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:j&&"4px",width:"100%"},children:[e.jsx("label",{className:"label-main",children:"Descrição dos acessórios"}),e.jsx("div",{style:j&&{border:"1px solid #ccc",padding:"16px",borderRadius:"8px"},children:j?e.jsx("span",{dangerouslySetInnerHTML:B(j)}):e.jsx("p",{children:"Sem valor"})})]})]}),footer:e.jsxs("footer",{children:[e.jsx("style",{children:`
            .p-footer {
              font-size: 10px;
            }
          `}),e.jsx("p",{style:{marginBottom:"8px"},className:"p-footer",children:"A apresentação deste documento é obrigatória para o levantamento do equipamento"}),e.jsx("hr",{style:{marginBottom:"8px"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"p-footer",style:{fontWeight:"bold"},children:"Para mais informações, entre em contacto conosco"}),e.jsx("p",{className:"p-footer",children:`${ne(v)} | ${f}`})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("p",{className:"p-footer",style:{fontWeight:"bold"},children:"Visite-nos"}),e.jsx("p",{className:"p-footer",children:A})]})]})]})})}),Ws=w.forwardRef(({equipmentId:s,companyData:g,isFinished:u},t)=>{if(!u)return;const{website:l,phone_number:i}=g;return e.jsx("div",{ref:t,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"36px"},children:[e.jsx("img",{src:`${se}/company/logo?size=1400`,style:{width:"360px"}}),e.jsx("h1",{style:{fontSize:54},children:s})]}),e.jsxs("p",{style:{fontSize:28,fontWeight:700,marginTop:"8px"},children:[ne(i),i&&l&&e.jsx("strong",{children:" | "}),l]})]})})}),Ke=s=>{const{children:g,value:u,index:t,...l}=s;return e.jsx(O,{sx:{margin:3},role:"tabpanel",hidden:u!==t,id:`repair-tabpanel-${t}`,"aria-labelledby":`repair-tab-${t}`,...l,children:u===t&&g})},Xe=s=>({id:`repair-tab-${s}`,"aria-controls":`repair-tabpanel-${s}`}),Os=({repair:s,isLoading:g,isError:u})=>{var M,F,x,oe,ae,de,re,ce,xe,me,he,pe,ue,je,ge,ye,fe,ve,be,De,Ce,Le,Ie,Se,we,Ne,Re,$e,Ae,ke,Te,We,_e,Ee,Pe,He,ze,Ve,Be,Me,Fe,Ue,Ge;const t=!g&&!u,[l,i]=w.useState(0),h=(n,r)=>{i(r)},[o,j]=w.useState(!1),N=w.useRef(null),f=w.useRef(null),A=w.useRef(null),C=w.useRef(null),L=async n=>{j(!0);try{await $s(n.current.innerHTML)}finally{j(!1)}},{control:a,handleSubmit:W,reset:R,getValues:v,formState:{errors:d}}=ys({resolver:bs(Ds)}),k={statusId:((F=(M=s==null?void 0:s[0])==null?void 0:M.status)==null?void 0:F.id)||"",entryDatetime:(x=s==null?void 0:s[0])!=null&&x.entry_datetime?new Date((oe=s==null?void 0:s[0])==null?void 0:oe.entry_datetime):null,entryAccessories:((de=(ae=s==null?void 0:s[0])==null?void 0:ae.entry_accessories)==null?void 0:de.map(n=>n.id))||[],entryAccessoriesDescription:((re=s==null?void 0:s[0])==null?void 0:re.entry_accessories_description)||"",entryReportedIssues:((xe=(ce=s==null?void 0:s[0])==null?void 0:ce.entry_reported_issues)==null?void 0:xe.map(n=>n.id))||[],entryReportedIssuesDescription:((me=s==null?void 0:s[0])==null?void 0:me.entry_reported_issues_description)||"",entryDescription:((he=s==null?void 0:s[0])==null?void 0:he.entry_description)||"",interventionWorksDone:((ue=(pe=s==null?void 0:s[0])==null?void 0:pe.intervention_works_done)==null?void 0:ue.map(n=>n.id))||[],interventionWorksDoneDescription:((je=s==null?void 0:s[0])==null?void 0:je.intervention_works_done_description)||"",interventionAccessoriesUsed:((ye=(ge=s==null?void 0:s[0])==null?void 0:ge.intervention_accessories_used)==null?void 0:ye.map(n=>n.id))||[],interventionAccessoriesUsedDescription:((fe=s==null?void 0:s[0])==null?void 0:fe.intervention_accessories_used_description)||"",conclusionDatetime:(ve=s==null?void 0:s[0])!=null&&ve.conclusion_datetime?new Date((be=s==null?void 0:s[0])==null?void 0:be.conclusion_datetime):null,deliveryDatetime:(De=s==null?void 0:s[0])!=null&&De.delivery_datetime?new Date((Ce=s==null?void 0:s[0])==null?void 0:Ce.delivery_datetime):null,isClientNotified:!!((Le=s==null?void 0:s[0])!=null&&Le.is_client_notified)||!1,interventionDescription:((Ie=s==null?void 0:s[0])==null?void 0:Ie.intervention_description)||""},{isDirty:T}=fs({control:a}),I=()=>!T;w.useEffect(()=>{t&&s&&s[0]&&R(k)},[t,s]);const{findAllRepairStatuses:E,findAllEntryAccessories:_,findAllEntryReportedIssues:Q,findAllInterventionWorksDone:J,findAllInterventionAccessoriesUsed:Y,updateRepair:K}=Cs(),{findCompany:P}=Ls(),S=P.isLoading,X=async n=>{!t||I()||await K.mutateAsync({repairId:s[0].id,...n,entryAccessoriesDescription:n.entryAccessoriesDescription===""?null:n.entryAccessoriesDescription,entryReportedIssuesDescription:n.entryReportedIssuesDescription===""?null:n.entryReportedIssuesDescription,entryDescription:n.entryDescription===""?null:n.entryDescription,interventionWorksDoneDescription:n.interventionWorksDoneDescription===""?null:n.interventionWorksDoneDescription,interventionAccessoriesUsedDescription:n.interventionAccessoriesUsedDescription===""?null:n.interventionAccessoriesUsedDescription,interventionDescription:n.interventionDescription===""?null:n.interventionDescription}).then(()=>js("Reparação atualizada com sucesso!")).catch(r=>{if(r.error.code==="EQU-008"){setError("sn",{type:"manual",message:"Número de série já existente"});return}gs("Erro ao atualizar reparação!")})},Z=[{label:"Cliente",link:`/client/${(we=(Se=s==null?void 0:s[0].equipment)==null?void 0:Se.client)==null?void 0:we.id}`,value:(Re=(Ne=s==null?void 0:s[0].equipment)==null?void 0:Ne.client)==null?void 0:Re.name,description:(Ae=($e=s==null?void 0:s[0].equipment)==null?void 0:$e.client)==null?void 0:Ae.description},{label:"Equipamento",link:`/equipment/${(ke=s==null?void 0:s[0].equipment)==null?void 0:ke.id}`,value:`${(We=(Te=s==null?void 0:s[0].equipment)==null?void 0:Te.type)==null?void 0:We.name}, ${(Ee=(_e=s==null?void 0:s[0].equipment)==null?void 0:_e.brand)==null?void 0:Ee.name} ${(He=(Pe=s==null?void 0:s[0].equipment)==null?void 0:Pe.model)==null?void 0:He.name}`,description:(ze=s==null?void 0:s[0].equipment)==null?void 0:ze.description}],q=vs({control:a,name:"isClientNotified"});return e.jsxs(ss,{elevation:1,children:[e.jsx(ns,{title:"Detalhes",description:"Dados da reparação",icon:e.jsx(ts,{})}),e.jsxs(is,{style:{display:"none"},children:[e.jsx(Ws,{ref:N,equipmentId:(Be=(Ve=s==null?void 0:s[0])==null?void 0:Ve.equipment)==null?void 0:Be.id,companyData:P.data,isFinished:!S&&t}),e.jsx(ks,{ref:f,repairData:s==null?void 0:s[0],companyData:P.data,isFinished:!S&&t}),e.jsx(Ts,{ref:A,repairData:s==null?void 0:s[0],companyData:P.data,isFinished:!S&&t}),e.jsx(As,{ref:C,repairData:s==null?void 0:s[0],companyData:P.data,isFinished:!S&&t})]}),e.jsx("form",{onSubmit:W(X),children:e.jsxs($,{children:[e.jsxs($,{children:[e.jsx(O,{sx:{paddingInline:3,paddingTop:2},children:e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"rounded",width:70,height:32}),LoadedComponent:e.jsx(ls,{label:(Fe=(Me=s==null?void 0:s[0])==null?void 0:Me.status)==null?void 0:Fe.name,color:Is((Ge=(Ue=s==null?void 0:s[0])==null?void 0:Ue.status)==null?void 0:Ge.color)})})}),e.jsx(Qe,{container:!0,spacing:2,sx:{paddingInline:3},children:Z.map((n,r)=>e.jsx(Qe,{item:!0,xs:12,children:e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsxs($,{children:[e.jsx(G,{variant:"p",component:"p",sx:{color:"var(--outline)",fontWeight:550},children:n.label}),n.value?e.jsxs($,{sx:{flexDirection:"row",alignItems:"center",gap:1},children:[e.jsx(G,{variant:"p",component:"p",children:n.isHtml?n.link?e.jsx(Je,{to:n.link,dangerouslySetInnerHTML:{__html:n.value}}):e.jsx("span",{dangerouslySetInnerHTML:{__html:n.value}}):n.link?e.jsx(Je,{to:n.link,children:n.value}):e.jsx("span",{children:n.value})}),n.description&&e.jsx(os,{title:n.description})]}):e.jsx(G,{variant:"p",component:"p",sx:{color:"var(--outline)"},children:"Sem valor"})]})})},r))}),e.jsx($,{sx:{padding:3,paddingTop:2,paddingBottom:0},children:e.jsx(b,{isLoading:!t||E.isLoading,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{fullWidth:!0,children:e.jsx(p,{name:"statusId",control:a,defaultValue:"",render:({field:n})=>{var c,Oe;const r=E.data??[],m=["",...r.map(U=>U.name)],y=((c=r.find(U=>U.id===n.value))==null?void 0:c.name)||"";return e.jsx(as,{ref:n.ref,label:"Estado",data:m,value:y,onChange:U=>{const te=r.find(qe=>qe.name===U);n.onChange((te==null?void 0:te.id)||"")},error:!!d.statusId,helperText:(Oe=d.statusId)==null?void 0:Oe.message})}})})})}),e.jsxs(O,{sx:{border:"2px solid var(--elevation-level5)",borderRadius:2,margin:3},children:[e.jsxs($,{sx:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid var(--elevation-level5)"},children:[e.jsxs(Ss,{value:l,onChange:h,"aria-label":"repair-tabs",variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{paddingInline:3},children:[e.jsx(Ye,{icon:e.jsx(Rs,{fontSize:"inherit"}),label:"Entrada",...Xe("Entrada")}),e.jsx(Ye,{icon:e.jsx(Ns,{fontSize:"inherit"}),label:"Intervenção",...Xe("Intervenção")})]}),e.jsx(O,{sx:{paddingRight:.5},children:e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"circular",width:40,height:40}),LoadedComponent:e.jsx(ds,{mode:"custom",customButton:e.jsx(rs,{title:"Mais opções",children:e.jsx(cs,{children:e.jsx(xs,{})})}),children:e.jsx(ms,{buttons:[{title:"Print",label:"Selo",onClick:()=>L(N),isSkeletonLoading:S},{label:"Ficha informativa",onClick:()=>L(f),isSkeletonLoading:S},{label:"Entrada",onClick:()=>L(A),isSkeletonLoading:S},,{label:"Entrega",onClick:()=>L(C),isSkeletonLoading:S}]})})})})]}),e.jsx(Ke,{value:l,index:0,children:e.jsxs($,{sx:{gap:2},children:[e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(p,{name:"entryDatetime",control:a,defaultValue:null,render:({field:n})=>{var r,m;return e.jsx(ie,{label:"Data de entrada",value:n.value,onChange:n.onChange,error:!!d.entryDatetime,helperText:(r=d.entryDatetime)==null?void 0:r.message,InputLabelProps:{shrink:((m=v("entryDatetime"))==null?void 0:m.length)>0}})}})}),e.jsx(b,{isLoading:!t||_.isLoading,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{fullWidth:!0,children:e.jsx(p,{name:"entryAccessories",control:a,defaultValue:[],render:({field:n})=>{var y;const m=(_.data??[]).map(c=>({id:c.id,name:c.name}));return e.jsx(ee,{label:"Acessórios",data:m,selectedIds:n.value,onChange:c=>{n.onChange(c)},error:!!d.entryAccessories,helperText:(y=d.entryAccessories)==null?void 0:y.message})}})})}),e.jsx(p,{name:"entryAccessoriesDescription",control:a,defaultValue:"",render:({field:n})=>e.jsx(V,{label:"Descrição dos acessórios",value:n.value,onChange:n.onChange,isLoading:!t})}),e.jsx(b,{isLoading:!t||Q.isLoading,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{fullWidth:!0,children:e.jsx(p,{name:"entryReportedIssues",control:a,defaultValue:[],render:({field:n})=>{var y;const m=(Q.data??[]).map(c=>({id:c.id,name:c.name}));return e.jsx(ee,{label:"Problemas reportados",data:m,selectedIds:n.value,onChange:c=>{n.onChange(c)},error:!!d.entryReportedIssues,helperText:(y=d.entryReportedIssues)==null?void 0:y.message})}})})}),e.jsx(p,{name:"entryReportedIssuesDescription",control:a,defaultValue:"",render:({field:n})=>e.jsx(V,{label:"Descrição dos problemas reportados",value:n.value,onChange:n.onChange,isLoading:!t})}),e.jsx(p,{name:"entryDescription",control:a,defaultValue:"",render:({field:n})=>e.jsx(V,{label:"Descrição da entrada",value:n.value,onChange:n.onChange,isLoading:!t})})]})}),e.jsx(Ke,{value:l,index:1,children:e.jsxs($,{sx:{gap:2},children:[e.jsx(b,{isLoading:!t||J.isLoading,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{fullWidth:!0,children:e.jsx(p,{name:"interventionWorksDone",control:a,defaultValue:[],render:({field:n})=>{var y;const m=(J.data??[]).map(c=>({id:c.id,name:c.name}));return e.jsx(ee,{label:"Trabalhos realizados",data:m,selectedIds:n.value,onChange:c=>{n.onChange(c)},error:!!d.interventionWorksDone,helperText:(y=d.interventionWorksDone)==null?void 0:y.message})}})})}),e.jsx(p,{name:"interventionWorksDoneDescription",control:a,defaultValue:"",render:({field:n})=>e.jsx(V,{label:"Descrição dos trabalhos realizados",value:n.value,onChange:n.onChange,isLoading:!t})}),e.jsx(b,{isLoading:!t||Y.isLoading,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{fullWidth:!0,children:e.jsx(p,{name:"interventionAccessoriesUsed",control:a,defaultValue:[],render:({field:n})=>{var y;const m=(Y.data??[]).map(c=>({id:c.id,name:c.name}));return e.jsx(ee,{label:"Acessórios usados",data:m,selectedIds:n.value,onChange:c=>{n.onChange(c)},error:!!d.interventionAccessoriesUsed,helperText:(y=d.interventionAccessoriesUsed)==null?void 0:y.message})}})})}),e.jsx(p,{name:"interventionAccessoriesUsedDescription",control:a,defaultValue:"",render:({field:n})=>e.jsx(V,{label:"Descrição dos acessórios usados",value:n.value,onChange:n.onChange,isLoading:!t})}),e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(p,{name:"conclusionDatetime",control:a,defaultValue:null,render:({field:n})=>{var r,m;return e.jsx(ie,{label:"Data de conclusão",value:n.value,minDate:v("entryDatetime"),onChange:n.onChange,error:!!d.conclusionDatetime,helperText:(r=d.conclusionDatetime)==null?void 0:r.message,InputLabelProps:{shrink:((m=v("conclusionDatetime"))==null?void 0:m.length)>0}})}})}),e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(p,{name:"deliveryDatetime",control:a,defaultValue:null,render:({field:n})=>{var r,m;return e.jsx(ie,{label:"Data de entrega",value:n.value,minDate:v("conclusionDatetime"),onChange:n.onChange,error:!!d.deliveryDatetime,helperText:(r=d.deliveryDatetime)==null?void 0:r.message,InputLabelProps:{shrink:((m=v("deliveryDatetime"))==null?void 0:m.length)>0}})}})}),e.jsx(b,{isLoading:!t,LoadingComponent:e.jsx(D,{variant:"rounded",width:"100%",height:52}),LoadedComponent:e.jsx(z,{fullWidth:!0,children:e.jsxs($,{sx:{flexDirection:"row",alignItems:"center"},children:[e.jsx(p,{name:"isClientNotified",control:a,render:({field:n})=>e.jsx(ws,{edge:"start",value:n.value,onChange:n.onChange,defaultChecked:k.isClientNotified})}),e.jsxs($,{children:[e.jsx(G,{variant:"p",component:"p",children:"Cliente notificado"}),e.jsx(G,{variant:"p",component:"p",sx:{color:"var(--outline)"},children:q?"Sim":"Não"})]})]})})}),e.jsx(p,{name:"interventionDescription",control:a,defaultValue:"",render:({field:n})=>e.jsx(V,{label:"Descrição da intervenção",value:n.value,onChange:n.onChange,isLoading:!t})})]})})]})]}),e.jsx(O,{sx:{padding:3,paddingTop:0,marginLeft:"auto"},children:e.jsx(hs,{loading:K.isPending,type:"submit",variant:"contained",disabled:!t||I(),children:"Atualizar Reparação"})})]})}),e.jsx(ps,{sx:{zIndex:99999},open:o,children:e.jsx(us,{})})]})};export{Os as default};
