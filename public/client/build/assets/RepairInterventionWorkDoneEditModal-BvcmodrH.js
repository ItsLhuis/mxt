import{r as m,j as t,aU as z,B as F,F as I,T as y,ak as w,s as B}from"./index-_NktdslD.js";import{u as P,b as M,t as N}from"./index-8QsUXVhp.js";import{o as U}from"./repair-j_MUsWAD.js";import{u as V}from"./useRepair-MRRzMLfz.js";const G=({interventionWorkDone:a,open:e,onClose:r})=>{var n,c;const s=m.useRef(null);m.useEffect(()=>{if(!e)return;const u=setTimeout(()=>{e&&s.current&&s.current.focus()},100);return()=>clearTimeout(u)},[e]);const{control:f,register:h,handleSubmit:p,getValues:x,formState:{errors:i},setError:b,reset:o}=P({resolver:N(U)}),E={name:(a==null?void 0:a.name)||""},{isDirty:T}=M({control:f}),l=()=>!T;m.useEffect(()=>{a&&o(E)},[a]);const{updateInterventionWorkDone:R}=V(),g=async u=>{if(!l())return new Promise((S,d)=>{R.mutateAsync({interventionWorkDoneId:a.id,...u}).then(()=>{r(),w("Trabalho realizado atualizado com sucesso!"),o(),S()}).catch(j=>{if(j.error.code==="REP-016"){b("name",{type:"manual",message:"Nome jÃ¡ existente"}),d();return}r(),B("Erro ao atualizar trabalho realizado!"),o(),d()})})};return t.jsx(z,{mode:"form",title:"Editar Trabalho Realizado",open:e,onClose:r,submitButtonText:"Editar Trabalho Realizado",onSubmit:p(g),disabled:l(),children:t.jsx(F,{sx:{padding:3},children:t.jsx(I,{fullWidth:!0,children:t.jsx(y,{...h("name"),label:"Nome",error:!!i.name,helperText:(n=i.name)==null?void 0:n.message,autoComplete:"off",inputRef:s,InputLabelProps:{shrink:((c=x("name"))==null?void 0:c.length)>0}})})})})};export{G as default};
