import{r as s,j as e,Z as o,Y as t,at as v,au as h,aE as j,B as n,aF as l,aG as g,ad as d,a as C,az as H,aw as _,ax as y}from"./index-DjYwzy8o.js";import{f as T,a as S}from"./date-CpdtD0wQ.js";import{f as c}from"./phone-CpiNNUiR.js";import{C as D,H as L}from"./History-CiXJ-6r-.js";const M=({client:p,isLoading:x,isError:f})=>{const i=!x&&!f,m=s.useMemo(()=>[{id:"type",label:"Atividade",align:"left",sortable:!0},{id:"created_at_datetime",label:"Responsável",align:"left",sortable:!0,renderComponent:({row:r})=>e.jsx(e.Fragment,{children:e.jsxs(o,{sx:{flexDirection:"row",gap:2},children:[e.jsx(o,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:r.responsible_user?e.jsxs(e.Fragment,{children:[e.jsx(v,{alt:r.responsible_user.username,src:`${h}/users/${r.responsible_user.id}/avatar?size=80`,name:r.responsible_user.username}),e.jsxs(o,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.responsible_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.responsible_user.role})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})}),e.jsx(j,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(o,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:T(r.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:S(r.created_at_datetime)})]})]})})}],[]),b=s.useMemo(()=>({row:r})=>{const u=s.useMemo(()=>[{id:"field",label:"Campo",align:"left",sortable:!0},{id:"before",label:"Antes",align:"left",sortable:!0,renderComponent:({row:a})=>a.field==="Descrição"&&a.before?e.jsx(n,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:l(a.before)})}):a.field==="Contacto"&&a.before?c(a.before):a.before?a.before:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"after",label:"Depois",align:"left",sortable:!0,renderComponent:({row:a})=>a.field==="Descrição"&&a.after?e.jsx(n,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:l(a.after)})}):a.field==="Contacto"&&a.after?c(a.after):a.after?a.after:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"changed",label:"Alterado",align:"left",sortable:!0,renderComponent:({row:a})=>e.jsx(e.Fragment,{children:a.changed?e.jsx(D,{color:"success"}):e.jsx(g,{color:"error"})})}],[]);return e.jsx(n,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden",margin:3},children:e.jsx(d,{data:r.details??[],columns:u})})},[]);return e.jsxs(C,{elevation:1,children:[e.jsx(H,{title:"Histórico de Atividades",description:"Histórico de atividades sobre os clientes",icon:e.jsx(L,{})}),e.jsx(_,{isLoading:!i,LoadingComponent:e.jsx(y,{mode:"datatable"}),LoadedComponent:e.jsx(n,{sx:{margin:3,border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:e.jsx(d,{mode:"datatable",data:i?p[0].interactions_history:[],columns:m,ExpandableContentComponent:b})})})]})};export{M as default};
