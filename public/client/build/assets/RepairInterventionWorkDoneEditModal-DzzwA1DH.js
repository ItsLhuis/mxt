import{r as m,j as t,aT as z,B as F,F as I,T as y,aj as w,s as B}from"./index-mWc9gLhA.js";import{u as P,b as M,t as N}from"./index-COzNbWAj.js";import{o as V}from"./repair-D-n4dckQ.js";import{u as A}from"./useRepair-BcwC0uik.js";const G=({interventionWorkDone:a,open:e,onClose:r})=>{var n,c;const s=m.useRef(null);m.useEffect(()=>{if(!e)return;const u=setTimeout(()=>{e&&s.current&&s.current.focus()},100);return()=>clearTimeout(u)},[e]);const{control:f,register:h,handleSubmit:p,getValues:x,formState:{errors:i},setError:b,reset:o}=P({resolver:N(V)}),T={name:(a==null?void 0:a.name)||""},{isDirty:E}=M({control:f}),l=()=>!E;m.useEffect(()=>{a&&o(T)},[a]);const{updateInterventionWorkDone:R}=A(),g=async u=>{if(!l())return new Promise((j,d)=>{R.mutateAsync({interventionWorkDoneId:a.id,...u}).then(()=>{r(),w("Trabalho realizado atualizado com sucesso!"),o(),j()}).catch(S=>{if(S.error.code==="REP-016"){b("name",{type:"manual",message:"Nome jÃ¡ existente"}),d();return}r(),B("Erro ao atualizar trabalho realizado!"),o(),d()})})};return t.jsx(z,{mode:"form",title:"Editar Trabalho Realizado",open:e,onClose:r,submitButtonText:"Editar Trabalho Realizado",onSubmit:p(g),disabled:l(),children:t.jsx(F,{sx:{padding:3},children:t.jsx(I,{fullWidth:!0,children:t.jsx(y,{...h("name"),label:"Nome",error:!!i.name,helperText:(n=i.name)==null?void 0:n.message,autoComplete:"off",inputRef:s,InputLabelProps:{shrink:((c=x("name"))==null?void 0:c.length)>0}})})})})};export{G as default};
