import{r as i,j as r,b2 as R,B as q,F as w,T as B,ab as I,s as z}from"./index-C9HasOiM.js";import{u as M,b as N,t as P}from"./index-BTi6rd4V.js";import{t as U}from"./equipment-D4V42Xnu.js";import{u as V}from"./useEquipment-ClzBGdbo.js";import"./equipment-DQ8Bx2dX.js";const L=({type:e,open:t,onClose:s})=>{var u,c;const o=i.useRef(null);i.useEffect(()=>{if(!t)return;const a=setTimeout(()=>{t&&o.current&&o.current.focus()},100);return()=>clearTimeout(a)},[t]);const{control:d,register:f,handleSubmit:p,getValues:h,formState:{errors:n},setError:x,reset:E}=M({resolver:P(U)}),T={name:(e==null?void 0:e.name)||""},{isDirty:b}=N({control:d}),m=()=>!b;i.useEffect(()=>{e&&E(T)},[e]);const{updateEquipmentType:g}=V(),S=async a=>{if(!m())return new Promise((j,l)=>{g.mutateAsync({typeId:e.id,...a}).then(()=>{s(),I("Tipo atualizado com sucesso!"),j()}).catch(F=>{if(F.error.code==="EQU-007"){x("name",{type:"manual",message:"Nome jÃ¡ existente"}),l();return}s(),z("Erro ao atualizar tipo!"),l()})})};return r.jsx(R,{mode:"form",title:"Editar Tipo",open:t,onClose:s,submitButtonText:"Editar Tipo",onSubmit:p(S),disabled:m(),children:r.jsx(q,{sx:{padding:3},children:r.jsx(w,{fullWidth:!0,children:r.jsx(B,{...f("name"),label:"Nome",error:!!n.name,helperText:(u=n.name)==null?void 0:u.message,autoComplete:"off",inputRef:o,InputLabelProps:{shrink:((c=h("name"))==null?void 0:c.length)>0}})})})})};export{L as default};
