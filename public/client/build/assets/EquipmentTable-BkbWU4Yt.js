import{u as T,S as z,r as n,j as e,Z as a,at as s,au as l,Y as t,aE as d,aa as E,ag as O,ah as $,ab as H,av as F,B as c,aF as h,aG as L,ad as x,az as u,a as A,aw as I,ax as R}from"./index-DjYwzy8o.js";import{u as B}from"./List-C-_tQcpv.js";import{f as p,a as m}from"./date-CpdtD0wQ.js";import{f}from"./phone-CpiNNUiR.js";import{M as P}from"./MoreVert-DQhEmQ3X.js";import{E as k}from"./Edit-BByoqxOd.js";import{C as q,H as U}from"./History-CiXJ-6r-.js";import{P as N}from"./Phone-D-5Xro_p.js";import{P as Y}from"./Place-BvbfEmTh.js";import"./Container-FxE9Zhx2.js";import"./Add-CR-vjWHF.js";const ie=()=>{const _=T(),{role:v}=z(),{findAllEquipments:j}=B(),{data:b,isLoading:g}=j;console.log(b);const y=n.useMemo(()=>[{id:"brand.name",label:"Marca",align:"left",sortable:!0,renderComponent:({row:i})=>e.jsx(e.Fragment,{children:i.brand.name})},{id:"created_by_user",label:"Criado por",align:"left",sortable:!0,renderComponent:({row:i})=>e.jsx(e.Fragment,{children:i.created_by_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:i.created_by_user.username,src:`${l}/users/${i.created_by_user.id}/avatar?size=80`,name:i.created_by_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:i.created_by_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:i.created_by_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(i.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(i.created_at_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})})},{id:"last_modified_by_user",label:"Modificado pela última vez por",align:"left",sortable:!1,renderComponent:({row:i})=>e.jsx(e.Fragment,{children:i.last_modified_by_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:i.last_modified_by_user.username,src:`${l}/users/${i.last_modified_by_user.id}/avatar?size=80`,name:i.last_modified_by_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:i.last_modified_by_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:i.last_modified_by_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(i.last_modified_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(i.last_modified_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Ainda não foi modificado"})})},{id:"moreOptions",align:"right",sortable:!1,renderComponent:({row:i})=>e.jsx(E,{mode:"custom",customButton:e.jsx(O,{title:"Mais opções",sx:{margin:-1},children:e.jsx($,{children:e.jsx(P,{})})}),children:e.jsx(H,{buttons:[{label:"Editar",icon:e.jsx(k,{fontSize:"small"}),onClick:()=>_(`/client/${i.id}`)},...v!=="Funcionário"?[{label:"Eliminar",icon:e.jsx(F,{fontSize:"small",color:"error"}),color:"error",divider:!0,onClick:()=>openDeleteClientModal(i.id)}]:[]]})})}],[]),C=n.useMemo(()=>({row:i})=>{const S=n.useMemo(()=>[{id:"type",label:"Tipo",align:"left",sortable:!0},{id:"contact",label:"Contacto",align:"left",sortable:!0,formatter:f},{id:"created_by_user",label:"Criado por",align:"left",sortable:!1,renderComponent:({row:r})=>e.jsx(e.Fragment,{children:r.created_by_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:r.created_by_user.username,src:`${l}/users/${r.created_by_user.id}/avatar?size=80`,name:r.created_by_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.created_by_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.created_by_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(r.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(r.created_at_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})})},{id:"last_modified_by_user",label:"Modificado pela última vez por",align:"left",sortable:!1,renderComponent:({row:r})=>e.jsx(e.Fragment,{children:r.last_modified_by_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:r.last_modified_by_user.username,src:`${l}/users/${r.last_modified_by_user.id}/avatar?size=80`,name:r.last_modified_by_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.last_modified_by_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.last_modified_by_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(r.last_modified_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(r.last_modified_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Ainda não foi modificado"})})}],[]),D=n.useMemo(()=>[{id:"country",label:"País",align:"left",sortable:!0},{id:"city",label:"Cidade",align:"left",sortable:!0},{id:"locality",label:"Localidade",align:"left",sortable:!0},{id:"address",label:"Morada",align:"left",sortable:!0},{id:"postal_code",label:"Código postal",align:"left",sortable:!0},{id:"created_by_user",label:"Criado por",align:"left",sortable:!1,renderComponent:({row:r})=>e.jsx(e.Fragment,{children:r.created_by_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:r.created_by_user.username,src:`${l}/users/${r.created_by_user.id}/avatar?size=80`,name:r.created_by_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.created_by_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.created_by_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(r.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(r.created_at_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})})},{id:"last_modified_by_user",label:"Modificado pela última vez por",align:"left",sortable:!1,renderComponent:({row:r})=>e.jsx(e.Fragment,{children:r.last_modified_by_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:r.last_modified_by_user.username,src:`${l}/users/${r.last_modified_by_user.id}/avatar?size=80`,name:r.last_modified_by_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.last_modified_by_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.last_modified_by_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(r.last_modified_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(r.last_modified_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Ainda não foi modificado"})})}],[]),w=n.useMemo(()=>[{id:"type",label:"Atividade",align:"left",sortable:!0},{id:"responsible_user",label:"Responsável",align:"left",sortable:!1,renderComponent:({row:r})=>e.jsx(e.Fragment,{children:r.responsible_user?e.jsxs(a,{sx:{flexDirection:"row",gap:2},children:[e.jsxs(a,{sx:{flexDirection:"row",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(s,{alt:r.responsible_user.username,src:`${l}/users/${r.responsible_user.id}/avatar?size=80`,name:r.responsible_user.username}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:r.responsible_user.username}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:r.responsible_user.role})]})]}),e.jsx(d,{sx:{borderColor:"var(--elevation-level5)",borderWidth:1}}),e.jsxs(a,{sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsx(t,{variant:"p",component:"p",fontWeight:500,children:p(r.created_at_datetime)}),e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:m(r.created_at_datetime)})]})]}):e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Utilizador removido"})})}],[]),M=n.useMemo(()=>({row:r})=>{const W=n.useMemo(()=>[{id:"field",label:"Campo",align:"left",sortable:!0},{id:"before",label:"Antes",align:"left",sortable:!0,renderComponent:({row:o})=>o.field==="Descrição"&&o.before?e.jsx(c,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:h(o.before)})}):o.field==="Contacto"&&o.before?f(o.before):o.before?o.before:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"after",label:"Depois",align:"left",sortable:!0,renderComponent:({row:o})=>o.field==="Descrição"&&o.after?e.jsx(c,{sx:{maxHeight:300,overflow:"hidden",overflowY:"auto",borderRadius:"8px",border:"1px solid var(--elevation-level5)",padding:2},children:e.jsx("span",{className:"table-cell-tiptap-editor",dangerouslySetInnerHTML:h(o.after)})}):o.field==="Contacto"&&o.after?f(o.after):o.after?o.after:e.jsx(t,{variant:"p",component:"p",color:"var(--outline)",children:"Sem valor"})},{id:"changed",label:"Alterado",align:"left",sortable:!0,renderComponent:({row:o})=>e.jsx(e.Fragment,{children:o.changed?e.jsx(q,{color:"success"}):e.jsx(L,{color:"error"})})}],[]);return e.jsx(c,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden",margin:3},children:e.jsx(x,{data:r.details??[],columns:W})})},[]);return e.jsxs(a,{sx:{margin:3,gap:3},children:[e.jsxs(c,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:[e.jsx(u,{title:"Contactos",description:"Contactos do cliente",icon:e.jsx(N,{})}),e.jsx(x,{mode:"datatable",data:i.contacts??[],columns:S})]}),e.jsxs(c,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:[e.jsx(u,{title:"Moradas",description:"Moradas do cliente",icon:e.jsx(Y,{})}),e.jsx(x,{mode:"datatable",data:i.addresses??[],columns:D})]}),v!=="Funcionário"&&e.jsxs(c,{sx:{border:"1px solid var(--elevation-level5)",borderRadius:2,overflow:"hidden"},children:[e.jsx(u,{title:"Histórico de Atividades",description:"Histórico de atividades sobre os clientes",icon:e.jsx(U,{})}),e.jsx(x,{mode:"datatable",data:i.interactions_history??[],columns:w,ExpandableContentComponent:M})]})]})},[]);return e.jsx(A,{elevation:1,children:e.jsx(c,{sx:{marginTop:3},children:e.jsx(I,{isLoading:g,LoadingComponent:e.jsx(R,{mode:"datatable"}),LoadedComponent:e.jsx(x,{mode:"datatable",data:b??[],columns:y,ExpandableContentComponent:C})})})})};export{ie as default};
